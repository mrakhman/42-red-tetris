(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{104:function(e,t,n){"use strict";var a=n(16),r=n.n(a),o=n(6),i=n.n(o),s=n(13),l=n.n(s),c=n(17),u=n.n(c),f=n(9),m=n.n(f),d=n(36),p=function(){function e(t){l()(this,e),this.type=t.type,t.timeStamp?this.timeStamp=t.timeStamp:this.timeStamp=Date.now(),t.shape?this.shape=t.shape:this.shape=d.d[this.type],t.pos?this.pos=t.pos:this.pos=d.f[this.type]}return u()(e,[{key:"rotate",value:function(){var t=this.shape;return new e({shape:t[0].map((function(e,n){return t.map((function(e){return e[n]})).reverse()})),type:this.type,pos:this.pos,timeStamp:this.timeStamp})}},{key:"fall",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new e({shape:this.shape,type:this.type,pos:[this.pos[0]+t,this.pos[1]],timeStamp:Date.now()})}},{key:"right",value:function(){return new e({shape:this.shape,type:this.type,pos:[this.pos[0],this.pos[1]+1],timeStamp:this.timeStamp})}},{key:"left",value:function(){return new e({shape:this.shape,type:this.type,pos:[this.pos[0],this.pos[1]-1],timeStamp:this.timeStamp})}},{key:"drop",value:function(t){for(var n=new e({type:this.type,pos:this.pos,shape:this.shape});n.fall().isValid(t);)n=n.fall();return n}},{key:"getBlockPos",value:function(){var e=this,t=[];return m.a.map(this.shape,(function(n,a){return m.a.map(n,(function(n,r){n&&t.push([a+e.pos[0],r+e.pos[1]])}))})),t}},{key:"getCorner",value:function(){var e,t,n,a,r=m.a.map(this.getBlockPos(),(function(e){return i()(e,1)[0]})),o=m.a.map(this.getBlockPos(),(function(e){return i()(e,2)[1]}));return{left:null!=(e=m.a.min(o))?e:0,top:null!=(t=m.a.min(r))?t:0,right:null!=(n=m.a.max(o))?n:0,bottom:null!=(a=m.a.max(r))?a:0}}},{key:"isBlock",value:function(e){return void 0!==m.a.find(this.getBlockPos(),(function(t){return m.a.isEqual(t,e)}))}},{key:"isValid",value:function(e){var t=m.a.find(this.getBlockPos(),(function(t){var n,a=i()(t,2),r=a[0],o=a[1];return null==e||null==(n=e[r])?void 0:n[o]})),n=this.getCorner(),a=n.left,r=n.right;return n.bottom<20&&a>=0&&r<10&&!t}},{key:"printBlock",value:function(e){var t=m.a.cloneDeep(e);return m.a.map(this.getBlockPos(),(function(e){e[0]>=0&&e[0]<m.a.size(t)&&e[1]>=0&&e[1]<m.a.size(t[0])&&(t[e[0]][e[1]]=1)})),t}},{key:"destroyBlock",value:function(e){var t=[],n=[];return m.a.map(e,(function(e){var a;(null!=(a=m.a.sum(e))?a:0)<10?t=m.a.cloneDeep([].concat(r()(t),[e])):n=m.a.cloneDeep([].concat(r()(n),[d.a]))})),m.a.cloneDeep([].concat(r()(n),r()(t)))}}]),e}();t.a=p},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(4),r=n(27),o=n(2),i=n(0),s=n(54),l=n(31),c=function(e){var t=e.size,n=e.color,a=e.label,l=e.style,c=e.onPress,u=e.disabled;return i.createElement(o.a,{style:[{alignItems:"center",margin:10},l]},i.createElement(s.a,{disabled:u,onPress:c,style:{backgroundColor:n,borderRadius:t/2,height:t,width:t,shadowColor:"rgba(0,0,0, .4)",shadowOffset:{height:1,width:1},shadowOpacity:20,shadowRadius:5}}),i.createElement(r.a,{style:{marginTop:10}},a))},u=function(e){var t=e.isPause,n=function(e){document.dispatchEvent(new KeyboardEvent("keydown",{keyCode:e,which:e}))};return i.createElement(o.a,null,i.createElement(o.a,{style:{flexDirection:"row"}},i.createElement(o.a,{style:{flex:1}},i.createElement(o.a,{style:{flexDirection:"row",marginTop:20}},i.createElement(c,{color:"#2dc421",size:50,label:"Pause/Play(P)",onPress:function(){return n(l.a.pause)}}),i.createElement(c,{color:"#2dc421",size:50,label:"Sound(S)",onPress:function(){return n(l.a.sound)}}),i.createElement(c,{color:"#efcc19",size:50,label:"Reset(R)",onPress:function(){return n(l.a.reset)}})),i.createElement(o.a,{style:{alignItems:"center"}},i.createElement(c,{color:"#5a65f1",size:160,label:"Drop(Space)",style:{marginTop:20},disabled:t,onPress:function(){return n(l.a.space)}}))),i.createElement(o.a,{style:{alignItems:"center",flex:1,justifyContent:"center"}},i.createElement(c,{color:"#5a65f1",size:70,style:{margin:0},disabled:t,onPress:function(){return n(l.a.rotate)}}),i.createElement(o.a,{style:{flexDirection:"row"}},i.createElement(c,{color:"#5a65f1",size:70,style:{margin:0,marginRight:60},disabled:t,onPress:function(){return n(l.a.left)}}),i.createElement(c,{color:"#5a65f1",size:70,style:{margin:0},disabled:t,onPress:function(){return n(l.a.right)}})),i.createElement(c,{color:"#5a65f1",size:70,style:{margin:0},disabled:t,onPress:function(){return n(l.a.down)}}))))},f=n(6),m=n.n(f),d=n(28),p=function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"window",t=i.useState((function(){return d.a.get(e)})),n=m()(t,2),a=n[0],r=n[1];return i.useEffect((function(){var t=!0,n=function(n){t&&r(n[e])};return d.a.addEventListener("change",n),function(){t=!1,d.a.removeEventListener("change",n)}}),[e,r]),a}("window")};function h(e){var t,n=e.children,a=e.isPause,s=p(),l=s.width,c=s.height;return t=c/l<1.5?c/960:l/560,i.createElement(o.a,{style:g.container},i.createElement(o.a,{style:[g.gameboy,{transform:[{scale:t}]}]},i.createElement(r.a,{style:g.title},"R E D \u25a0 T E T R I S"),i.createElement(o.a,{style:g.display},n,a?i.createElement(o.a,{style:[g.display,{position:"absolute",opacity:.8}]},i.createElement(r.a,null,"Press Play(P) to start")):null),i.createElement(u,{isPause:a})))}var g=a.a.create({container:{flex:1,backgroundColor:"#009688",alignItems:"center",justifyContent:"center",padding:20,height:"100%"},display:{alignItems:"center",backgroundColor:"#9ead86",borderBottomColor:"#fa6b6b",borderLeftColor:"#980f0f",borderRightColor:"#fa6b6b",borderTopColor:"#980f0f",borderWidth:5,height:470,justifyContent:"center",padding:10,width:400},gameboy:{justifyContent:"center",alignItems:"center",backgroundColor:"#af0000",borderRadius:20,paddingBottom:50,paddingHorizontal:50},title:{fontSize:30,marginVertical:20,textAlign:"center"}})},148:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(9),r=n.n(a),o=n(397),i=n(270),s=n(2),l=n(0);function c(e){var t=e.style,a=o.a.fromModule(n(374)).uri;return l.createElement(s.a,{style:[{flexDirection:"row"},t]},r.a.map(Array(6),(function(e,t){return l.createElement(i.a,{key:t,source:{uri:a},style:{width:14,height:24,overflow:"hidden"},imageStyle:{height:186,left:-215,resizeMode:"cover",top:-25,width:400}})})))}},179:function(e,t,n){"use strict";var a=n(9),r=n.n(a),o=n(2),i=n(4),s=n(0),l=i.a.create({container:{marginRight:2,marginBottom:2},outer:{alignItems:"center",borderColor:"#879372",borderWidth:1,height:20,justifyContent:"center",width:20},inner:{height:12,width:12,backgroundColor:"#879372"}}),c=function(e){var t=e.value;return s.createElement(o.a,{style:[l.outer,t?{borderColor:"black"}:void 0]},s.createElement(o.a,{style:[l.inner,t?{backgroundColor:"black"}:void 0]}))},u=(t.a=function(e){var t=e.block,n=e.matrix,a=e.style;return s.createElement(o.a,{style:[u.container,{height:22*r.a.size(n)},a]},r.a.map(n,(function(e,n){return s.createElement(o.a,{key:n,style:{flexDirection:"row",width:22*r.a.size(e),justifyContent:"space-between"}},r.a.map(e,(function(e,a){return s.createElement(c,{key:a,value:t.isBlock([n,a])?1:e})})))})))},i.a.create({container:{padding:2,justifyContent:"space-between",borderColor:"black",borderWidth:1,backgroundColor:"#9ead86"}}))},264:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var a=n(6),r=n.n(a),o=n(0),i=n.n(o),s=n(9),l=n.n(s),c=(n(336),n(2)),u=n(27),f=n(169),m=n(265),d=n(266),p=n.n(d),h=n(22),g=n(267),y=n.n(g),E=n(36),b=n(31),v=n(104),k=n(148),w=n(272),S=n(147),P=n(179),x=y()(""+(e&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}})&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}}).EXPO_SOCKET_URL||"http://localhost:3001"));function C(){var e,t=Object(h.useRoute)().params,n=null!=t?t:{},a=n.room,s=n.username,d=Object(o.useState)([]),g=r()(d,2),y=g[0],C=g[1],T=Object(o.useState)(new v.a({type:null!=(e=l.a.sample(E.e))?e:"T"})),z=r()(T,2),O=z[0],j=z[1],B=Object(o.useState)(E.b),R=r()(B,2),I=R[0],V=R[1],D=Object(o.useState)(!0),L=r()(D,2),N=L[0],A=L[1];Object(o.useEffect)((function(){x.emit("joinRoom",{username:s,room:a}),x.on("message",(function(e){e.username!==s&&Object(f.addResponseMessage)(e.username+": "+e.text,e.username)})),x.on("update room users",(function(e){C(e.users.map((function(e){return e.username})))}))}),[]);var W=E.e[(l.a.indexOf(E.e,O.type)+1)%l.a.size(E.e)];return Object(m.a)((function(){N||(l.a.includes(I[0],1)?(V(E.b),A(!0)):j((function(e){return O.fall().isValid(I)?e.fall():(V(O.destroyBlock(O.printBlock(I))),new v.a({type:W}))})))}),500),p()((function(e,t){var n,a=t.keyCode;(a===b.a.pause&&A((function(e){return!e})),a===b.a.reset)&&(j(new v.a({type:null!=(n=l.a.sample(E.e))?n:"T"})),V(E.b),A(!0));A((function(e){return V((function(t){return e||(a===b.a.rotate&&j((function(e){return e.rotate().isValid(t)?e.rotate():e})),a===b.a.left&&j((function(e){return e.left().isValid(t)?e.left():e})),a===b.a.right&&j((function(e){return e.right().isValid(t)?e.right():e})),a===b.a.down&&j((function(e){return e.fall().isValid(t)?e.fall():e})),a===b.a.space&&j((function(e){return e.drop(t)}))),t})),e}))})),i.a.createElement(i.a.Fragment,null,i.a.createElement(S.a,{isPause:N},i.a.createElement(c.a,{style:{flexDirection:"row",alignSelf:"flex-start",width:"100%"}},i.a.createElement(P.a,{matrix:I,block:O}),i.a.createElement(c.a,{style:{marginLeft:20,flex:1}},i.a.createElement(u.a,{style:{fontSize:20}},"Score"),i.a.createElement(k.a,{style:{marginVertical:10,alignSelf:"flex-end"}}),i.a.createElement(u.a,{style:{fontSize:20}},"Start Line"),i.a.createElement(k.a,{style:{marginVertical:10,alignSelf:"flex-end"}}),i.a.createElement(u.a,{style:{fontSize:20}},"Level"),i.a.createElement(k.a,{style:{marginVertical:10,alignSelf:"flex-end"}}),i.a.createElement(u.a,{style:{fontSize:20}},"Next"),i.a.createElement(P.a,{matrix:E.c,block:new v.a({type:W,pos:[0,0]}),style:{borderWidth:0,marginVertical:10,alignSelf:"flex-end"}})))),a&&s&&i.a.createElement(f.Widget,{title:"RedTetris",subtitle:Object(w.a)(y),handleNewUserMessage:function(e){x.emit("chatMessage",e)}}))}}).call(this,n(15))},272:function(e,t,n){"use strict";t.a=function(e){return 0===e.length?"No players":"Players: "+e.join(", ")}},290:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(231),r=n(0),o=n.n(r),i=n(402),s=n(229),l=n(225),c=n(72),u=n(401),f=n(4),m=n(27),d=n(54),p=n(2);function h(e){var t=e.navigation;return r.createElement(p.a,{style:g.container},r.createElement(m.a,{style:g.title},"This screen doesn't exist."),r.createElement(d.a,{onPress:function(){return t.replace("Root")},style:g.link},r.createElement(m.a,{style:g.linkText},"Go to home screen!")))}var g=f.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}}),y=n(6),E=n.n(y),b=n(45),v=n(22),k=n(147);function w(){var e=Object(v.useNavigation)(),t=r.useState(),n=E()(t,2),a=n[0],o=n[1],i=r.useState(),s=E()(i,2),l=s[0],c=s[1];return r.createElement(k.a,null,r.createElement(p.a,{style:{alignItems:"center"}},r.createElement(m.a,{style:S.title},"Username"),r.createElement(b.a,{value:null!=a?a:"",onChangeText:o,style:{borderWidth:1,marginBottom:20,height:30}}),r.createElement(m.a,{style:S.title},"Room"),r.createElement(b.a,{value:null!=l?l:"",onChangeText:c,style:{borderWidth:1,marginBottom:20,height:30}}),r.createElement(d.a,{style:{marginBottom:20},onPress:function(){return a&&l&&e.push("Playground",{username:a,room:l})}},r.createElement(m.a,{style:S.linkText},"Join Room")),r.createElement(d.a,{onPress:function(){return e.push("Playground",{})}},r.createElement(m.a,{style:S.linkText},"Solo mode"))))}var S=f.a.create({title:{marginBottom:10,alignSelf:"flex-start"},linkText:{fontSize:14,color:"#004580"}}),P=n(264),x={prefixes:[n(273).makeUrl("/")],config:{screens:{Root:"/",Playground:"/play",NotFound:"*"}}};function C(e){var t=e.colorScheme;return r.createElement(s.a,{linking:x,theme:"dark"===t?l.a:c.a},r.createElement(z,null))}var T=Object(u.a)();function z(){return r.createElement(T.Navigator,{screenOptions:{headerShown:!1}},r.createElement(T.Screen,{name:"Root",component:w}),r.createElement(T.Screen,{name:"Playground",component:P.a}),r.createElement(T.Screen,{name:"NotFound",component:h,options:{title:"Oops!"}}))}function O(){return o.a.createElement(i.b,null,o.a.createElement(C,null),o.a.createElement(a.StatusBar,null))}},304:function(e,t,n){n(305),e.exports=n(395)},305:function(e,t){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/expo-service-worker.js",{scope:"/"}).then((function(e){})).catch((function(e){console.info("Failed to register service-worker",e)}))}))},31:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={left:37,rotate:38,right:39,down:40,space:32,sound:83,reset:82,pause:80}},36:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var a=n(9),r=n.n(a),o={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]],S:[[0,1,1],[1,1,0],[0,0,0]],O:[[1,1],[1,1]],T:[[0,1,0],[1,1,1],[0,0,0]]},i={I:[-2,3],L:[-2,4],J:[-2,4],Z:[-2,4],S:[-2,4],O:[-2,4],T:[-2,4]},s=["I","L","J","Z","S","O","T"],l=[0,0,0,0,0,0,0,0,0,0],c=r.a.map(Array(20),(function(){return r.a.map(Array(10),0)})),u=r.a.map(Array(2),(function(){return r.a.map(Array(4),0)}))},364:function(e,t){},374:function(e,t,n){e.exports=n.p+"static/media/sprite.81de6409.png"}},[[304,1,2]]]);
//# sourceMappingURL=app.3e8bb0af.chunk.js.map