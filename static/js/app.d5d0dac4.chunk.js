(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{131:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return m}));var a=n(10),r=n.n(a),o=n(174),s=n.n(o),i=function(e){return void 0===e||null===e||""===e},c=function(e){return!i(e)&&!(e&&e.length>15)},l=function(e){var t=new RegExp("\\W");return!!e&&!e.match(t)},u=function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(c(t)){a.next=2;break}throw Error("Name must be 1-15 symbols");case 2:if(l(t)){a.next=4;break}throw Error("Use letters and numbers");case 4:return a.prev=4,a.next=7,r.a.awrap(s.a.get((e&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{scheme:"red-tetris",name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}})&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{scheme:"red-tetris",name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}}).SERVER_URL||"http://localhost:3001")+"/player/"+t));case 7:if(n=a.sent,!i(n.data.username)){a.next=10;break}return a.abrupt("return",!0);case 10:throw Error("Username already taken");case 13:if(a.prev=13,a.t0=a.catch(4),"Username already taken"!==a.t0.message){a.next=17;break}throw Error("Username already taken");case 17:console.log(a.t0);case 18:case"end":return a.stop()}}),null,null,[[4,13]],Promise)},m=function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(c(t)){a.next=2;break}throw Error("Name must be 1-15 symbols");case 2:if(l(t)){a.next=4;break}throw Error("Use letters and numbers");case 4:return a.prev=4,a.next=7,r.a.awrap(s.a.get((e&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{scheme:"red-tetris",name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}})&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{scheme:"red-tetris",name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}}).SERVER_URL||"http://localhost:3001")+"/room/"+t));case 7:if(n=a.sent,!i(n.data.name)){a.next=10;break}return a.abrupt("return",!0);case 10:throw Error("Room name already taken");case 13:if(a.prev=13,a.t0=a.catch(4),"Room name already taken"!==a.t0.message){a.next=17;break}throw Error("Room name already taken");case 17:console.log(a.t0);case 18:case"end":return a.stop()}}),null,null,[[4,13]],Promise)}}).call(this,n(14))},17:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={CREATE_USER:"create user",FETCH_CURRENT_PLAYER:"fetch current player",CHOOSE_ROOM:"create or join room",ENTER_ROOM:"enter room",UPDATE_ROOM_PLAYERS:"update room players",PLAYER_LEFT:"player left",START_GAME:"start game",PENALTY_ROWS:"penalty rows",FETCH_WAITING_ROOMS:"fetch waiting rooms",UPDATE_WAITING_ROOMS:"update waiting rooms",GAMEOVER:"gameover",FETCH_ROOM_RANKING:"fetch room ranking",CHAT_MESSAGE:"chat message",FORBIDDEN:"access forbidden"}},241:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(242),r=n(0),o=n.n(r),s=n(428),i=n(243);function c(){return o.a.createElement(s.b,null,o.a.createElement(i.a,null),o.a.createElement(a.StatusBar,null))}},243:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var a=n(5),r=n.n(a),o=n(168),s=n(166),i=n(73),c=n(427),l=n(0),u=n.n(l),m=n(244),f=n(306),d=n(303),E=n(283),p=n(284),g=n(287),b=n.n(g),h=n(45),y=n(38);function v(e){var t=e.colorScheme;return u.a.createElement(o.a,{linking:p.a,theme:"dark"===t?s.a:i.a},u.a.createElement(O,null))}var C=Object(c.a)();function O(){var t=Object(l.useState)(void 0),n=r()(t,2),a=n[0],o=n[1],s=Object(l.useState)({username:void 0,room:void 0}),i=r()(s,2),c=i[0],p=i[1];return u.a.createElement(h.a.Provider,{value:function(){if(a)return a;var t=b()(""+(e&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{scheme:"red-tetris",name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}})&&Object({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{scheme:"red-tetris",name:"red-tetris",slug:"red-tetris",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",splash:{image:"./assets/splash.png",resizeMode:"contain",backgroundColor:"#ffffff"},updates:{fallbackToCacheTimeout:0},assetBundlePatterns:["**/*"],web:{},sdkVersion:"38.0.0",platforms:["ios","android","web"]}}).SERVER_URL||"http://localhost:3001"));return o(t),t}()},u.a.createElement(y.a.Provider,{value:{userContext:c,setUserContext:p}},u.a.createElement(C.Navigator,{screenOptions:{headerShown:!1}},u.a.createElement(C.Screen,{name:"Root",component:f.a}),u.a.createElement(C.Screen,{name:"Playground",component:d.a}),u.a.createElement(C.Screen,{name:"Ranking",component:E.a}),u.a.createElement(C.Screen,{name:"NotFound",component:m.a,options:{title:"Oops!"}}))))}}).call(this,n(14))},244:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(0),r=n(3),o=n(9),s=n(46),i=n(2);function c(e){var t=e.navigation;return a.createElement(i.a,{style:l.container},a.createElement(o.a,{style:l.title},"This screen doesn't exist."),a.createElement(s.a,{onPress:function(){return t.replace("Root")},style:l.link},a.createElement(o.a,{style:l.linkText},"Go to home screen!")))}var l=r.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}})},283:function(e,t,n){"use strict";var a=n(5),r=n.n(a),o=n(0),s=n.n(o),i=n(7),c=n.n(i),l=n(3),u=n(2),m=n(9),f=n(20),d=n(83),E=n(17),p=n(45),g=n(38),b=l.a.create({title:{fontSize:26,fontWeight:"bold",alignSelf:"center",marginBottom:"10%"},subtitle:{fontSize:24,alignSelf:"center",marginBottom:"10%"},tableContainer:{width:300,flexDirection:"row",justifyContent:"space-between"},tableHeader:{fontSize:18,fontWeight:"bold"},tableContent:{fontSize:18,marginBottom:3,marginTop:3}});t.a=function(e){var t=Object(o.useContext)(p.a),n=Object(o.useContext)(g.a),a=(n.userContext,n.setUserContext,Object(f.useRoute)().params),i=null!=a?a:{},l=i.room,h=i.username,y=Object(o.useState)([]),v=r()(y,2),C=v[0],O=v[1];console.log("roomPlayers:",C);var S=function(){console.log("aaaaaaaaaaaa forbidden")},R=function(e){O(e)};Object(o.useEffect)((function(){if(!t)throw Error("No socket");return t.emit(E.a.FETCH_ROOM_RANKING,{username:h,roomName:l,gameMode:"not solo"}),t.on(E.a.FORBIDDEN,S),t.on(E.a.FETCH_ROOM_RANKING,R),function(){t.removeListener(E.a.FORBIDDEN,S),t.removeListener(E.a.FETCH_ROOM_RANKING,R)}}),[]);var w=[{username:"sqss",room:"1",id:"aaa",score:22800},{username:"bbb",room:"1",id:"bbb",score:12003},{username:"ccc",room:"1",id:"acccaa",score:5453},{username:"ddd",room:"1",id:"acccaa",score:5453},{username:"eee",room:"1",id:"acccaa",score:5453},{username:"fff",room:"1",id:"acccaa",score:5453},{username:"ggg",room:"1",id:"acccaa",score:5453},{username:"hhh",room:"1",id:"acccaa",score:5453},{username:"iii",room:"1",id:"acccaa",score:5453},{username:"jjj",room:"1",id:"acccaa",score:5453}];return s.a.createElement(d.a,null,s.a.createElement(u.a,{style:{justifyContent:"space-between"}},s.a.createElement(m.a,{style:b.title},"Game report"),h===w[0].username?s.a.createElement(m.a,{style:b.subtitle},h,", you are the winner!"):s.a.createElement(m.a,{style:b.subtitle},h," @ ",l),s.a.createElement(u.a,{style:b.tableContainer},s.a.createElement(u.a,null,s.a.createElement(m.a,{style:b.tableHeader},"Place"),c.a.map(w,(function(e,t){return s.a.createElement(m.a,{key:t,style:b.tableContent},t+1)}))),s.a.createElement(u.a,null,s.a.createElement(m.a,{style:b.tableHeader},"Name"),c.a.map(w,(function(e,t){return s.a.createElement(m.a,{key:t,style:b.tableContent},e.username)}))),s.a.createElement(u.a,null,s.a.createElement(m.a,{style:b.tableHeader},"Lines"),c.a.map(w,(function(e,t){return s.a.createElement(m.a,{key:t,style:b.tableContent},Math.floor(e.score/10))}))),s.a.createElement(u.a,null,s.a.createElement(m.a,{style:b.tableHeader},"Score"),c.a.map(w,(function(e,t){return s.a.createElement(m.a,{key:t,style:b.tableContent},e.score)}))))))}},284:function(e,t,n){"use strict";var a=n(285);t.a={prefixes:[a.makeUrl("/")],config:{screens:{Root:"/",Playground:"/play",Ranking:"/ranking",NotFound:"*"}}}},303:function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var a,r=n(12),o=n.n(r),s=n(5),i=n.n(s),c=n(0),l=n.n(c),u=n(7),m=n.n(u),f=n(2),d=n(9),E=n(277),p=n(20),g=n(17),b={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]],S:[[0,1,1],[1,1,0],[0,0,0]],O:[[1,1],[1,1]],T:[[0,1,0],[1,1,1],[0,0,0]]},h={I:[-2,3],L:[-2,4],J:[-2,4],Z:[-2,4],S:[-2,4],O:[-2,4],T:[-2,4]},y=["I","L","J","Z","S","O","T"];!function(e){e[e.FREE=0]="FREE",e[e.OCCUPIED=1]="OCCUPIED",e[e.BLOCKED=2]="BLOCKED"}(a||(a={}));m.a.fill(Array(10),a.OCCUPIED);var v=m.a.fill(Array(10),a.FREE),C=m.a.fill(Array(10),a.BLOCKED),O=m.a.map(Array(20),(function(){return m.a.fill(Array(10),a.FREE)})),S=m.a.map(Array(2),(function(){return m.a.fill(Array(4),a.FREE)})),R=(n(367),n(156)),w=n(432),P=n(280);function T(e){var t=e.style,a=w.a.fromModule(n(377)).uri;return c.createElement(f.a,{style:[{flexDirection:"row"},t]},m.a.map(Array(6),(function(e,t){return c.createElement(P.a,{key:t,source:{uri:a},style:{width:14,height:24,overflow:"hidden"},imageStyle:{height:186,left:-215,resizeMode:"cover",top:-25,width:400}})})))}var x=function(e){return e&&0!==e.length?e.map((function(e){return e.username})):[]},k=n(83),N=n(3),A=N.a.create({container:{marginRight:2,marginBottom:2},outer:{alignItems:"center",borderColor:"#879372",borderWidth:1,height:20,justifyContent:"center",width:20},inner:{height:12,width:12,backgroundColor:"#879372"}}),_=function(e){var t=e.value;return c.createElement(f.a,{style:[A.outer,t===a.OCCUPIED||t===a.BLOCKED?{borderColor:"black"}:void 0]},c.createElement(f.a,{style:[A.inner,t===a.OCCUPIED?{backgroundColor:"black"}:t===a.BLOCKED?{backgroundColor:"transparent"}:void 0]}))},L=function(e){var t=e.pos,n=e.shape,a=e.type,r=e.timeStamp;return{pos:null!=t?t:h[a],shape:null!=n?n:b[a],type:a,timeStamp:null!=r?r:Date.now()}},j=function(e){var t=e.shape,n=t[0].map((function(e,n){return t.map((function(e){return e[n]})).reverse()}));return{pos:e.pos,shape:n,type:e.type,timeStamp:e.timeStamp}},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{pos:[e.pos[0]+t,e.pos[1]],shape:e.shape,type:e.type,timeStamp:e.timeStamp}},M=function(e){return{pos:[e.pos[0],e.pos[1]+1],shape:e.shape,type:e.type,timeStamp:e.timeStamp}},U=function(e){return{pos:[e.pos[0],e.pos[1]-1],shape:e.shape,type:e.type,timeStamp:e.timeStamp}},D=function(e){var t=[];return m.a.map(e.shape,(function(n,a){return m.a.map(n,(function(n,r){n&&t.push([a+e.pos[0],r+e.pos[1]])}))})),t},B=function(e,t){return void 0!==m.a.find(D(e),(function(e){return m.a.isEqual(e,t)}))},z=function(e,t){var n=m.a.find(D(e),(function(e){var n,r,o=i()(e,2),s=o[0],c=o[1];return(null==t||null==(n=t[s])?void 0:n[c])===a.BLOCKED||(null==t||null==(r=t[s])?void 0:r[c])===a.OCCUPIED})),r=function(e){var t,n,a,r,o=m.a.map(D(e),(function(e){return i()(e,1)[0]})),s=m.a.map(D(e),(function(e){return i()(e,2)[1]}));return{left:null!=(t=m.a.min(s))?t:0,top:null!=(n=m.a.min(o))?n:0,right:null!=(a=m.a.max(s))?a:0,bottom:null!=(r=m.a.max(o))?r:0}}(e),o=r.left,s=r.right;return r.bottom<20&&o>=0&&s<10&&!n},F=function(e,t){var n=m.a.cloneDeep(t);return m.a.map(D(e),(function(e){e[0]>=0&&e[0]<m.a.size(n)&&e[1]>=0&&e[1]<m.a.size(n[0])&&(n[e[0]][e[1]]=a.OCCUPIED)})),n},W=function(e){var t=e.block,n=e.matrix,r=e.style;return c.createElement(f.a,{style:[G.container,{height:22*m.a.size(n)},r]},m.a.map(n,(function(e,n){return c.createElement(f.a,{key:n,style:{flexDirection:"row",width:22*m.a.size(e),justifyContent:"space-between"}},m.a.map(e,(function(e,r){return c.createElement(_,{key:r,value:B(t,[n,r])?a.OCCUPIED:e})})))})))},G=N.a.create({container:{padding:2,justifyContent:"space-between",borderColor:"black",borderWidth:1,backgroundColor:"#9ead86"}}),H=n(282),V=n.n(H),Y=n(32),K=function(e){var t=e.setIsPause,n=e.setMatrix,a=e.setBlock;V()((function(e,r){var o,s=r.keyCode;(s===Y.a.pause&&t((function(e){return!e})),s===Y.a.reset)&&(a(L({type:null!=(o=m.a.sample(y))?o:"T"})),n(O),t(!0));t((function(e){return n((function(t){return e||(s===Y.a.rotate&&a((function(e){return z(j(e),t)?j(e):e})),s===Y.a.left&&a((function(e){return z(U(e),t)?U(e):e})),s===Y.a.right&&a((function(e){return z(M(e),t)?M(e):e})),s===Y.a.down&&a((function(e){return z(I(e),t)?I(e):(n(F(e,t)),e)})),s===Y.a.space&&a((function(e){var a=function(e,t){for(var n=L({type:e.type,pos:e.pos,shape:e.shape});z(I(n),t);)n=I(n);return n}(e,t);return n(F(a,t)),a}))),t})),e}))}))},J=n(45),Z=n(38);function q(){var e,t,n=Object(c.useContext)(J.a),a=Object(c.useContext)(Z.a),r=a.userContext,s=a.setUserContext,u=Object(p.useNavigation)(),b=Object(p.useRoute)().params,h=null!=b?b:{},w=h.room,P=h.username,N=Object(c.useState)([]),A=i()(N,2),_=A[0],j=A[1],M=Object(c.useState)(L({type:null!=(e=m.a.sample(y))?e:"T"})),U=i()(M,2),D=U[0],B=U[1],G=Object(c.useState)(O),H=i()(G,2),V=H[0],Y=H[1],q=Object(c.useState)(!0),Q=i()(q,2),X=Q[0],$=Q[1],ee=Object(c.useState)(),te=i()(ee,2),ne=te[0],ae=te[1],re=Object(c.useState)(),oe=i()(re,2),se=oe[0],ie=oe[1],ce=Object(c.useState)(!1),le=i()(ce,2),ue=le[0],me=le[1],fe=!w||!P;K({setBlock:B,setMatrix:Y,setIsPause:$});var de=function(e){Object(R.addResponseMessage)(e.username+": "+e.text,e.username)},Ee=function(e){ae(e),console.log("FETCH_CURRENT_PLAYER",e)},pe=function(e){j(e.players);var t=m.a.find(e.players,(function(e){return e.isLeader}));ie(t),ae((function(e){return e&&t&&e.id===t.id?t:e}))},ge=function(e){var t=e.tilesStack,n=e.startTile;console.log("START_GAME",n,t,X),$(!1)},be=function(e){Y((function(t){var n=Ce(t,e);return console.log("PENALTY_ROWS receive. rowsNumber, newMatrix:",e,n),n}))},he=function(e){console.log("Game players, endGame:",e.players,e.endGame),e.endGame&&$(!0),u.push("Ranking",{username:P,room:w})};Object(c.useEffect)((function(){if(s({username:P,room:w}),console.log("Playground, User context:",r),!n)throw Error("No socket");return n.emit(g.a.ENTER_ROOM,{username:P,roomName:w}),n.on(g.a.CHAT_MESSAGE,de),n.on(g.a.FETCH_CURRENT_PLAYER,Ee),n.on(g.a.UPDATE_ROOM_PLAYERS,pe),n.on(g.a.START_GAME,ge),n.on(g.a.PENALTY_ROWS,be),n.on(g.a.GAMEOVER,he),function(){n.emit(g.a.PLAYER_LEFT,P),n.removeListener(g.a.CHAT_MESSAGE,de),n.removeListener(g.a.FETCH_CURRENT_PLAYER,Ee),n.removeListener(g.a.UPDATE_ROOM_PLAYERS,pe),n.removeListener(g.a.START_GAME,ge),n.removeListener(g.a.PENALTY_ROWS,be),n.removeListener(g.a.GAMEOVER,he)}}),[]);var ye,ve,Ce=function(e,t){var n=Array(t).fill(C),a=m.a.cloneDeep([].concat(o()(e),o()(n)));return m.a.slice(a,t,a.length)},Oe=y[0];return Object(E.a)((function(){X||(m.a.includes(V[0],1)?(Y(O),$(!0),me(!0),function(){if(!n)throw Error("No socket");n.emit(g.a.GAMEOVER,{username:r.username,roomName:r.room})}()):B((function(e){if(z(I(e),V))return I(e);var t=function(e){var t=[],n=[];return m.a.map(e,(function(e){m.a.sum(e)<10||m.a.sum(e)>10?t=m.a.cloneDeep([].concat(o()(t),[e])):n=m.a.cloneDeep([].concat(o()(n),[v]))})),console.log("Destroy",m.a.cloneDeep([].concat(o()(n),o()(t)))),{newMatrix:m.a.cloneDeep([].concat(o()(n),o()(t))),deletedRows:n.length}}(F(D,V)),a=t.newMatrix,r=t.deletedRows;return Y(a),r>0&&function(e){if(!n)throw Error("No socket");console.log("PENALTY_ROWS emit, rowsNumber:",e),n.emit(g.a.PENALTY_ROWS,{username:P,roomName:w,rowsNumber:e})}(r),L({type:Oe})})))}),500),l.a.createElement(l.a.Fragment,null,l.a.createElement(k.a,{isPause:X,roomPlayers:x(_),isLeader:null==ne?void 0:ne.isLeader,gameover:ue,isSoloMode:fe},l.a.createElement(l.a.Fragment,null,P&&w&&l.a.createElement(d.a,{style:{fontSize:16,marginBottom:10,alignSelf:"flex-start"}},P," @ ",w),l.a.createElement(f.a,{style:{flexDirection:"row",alignSelf:"flex-start",width:"100%"}},l.a.createElement(W,{matrix:V,block:D}),l.a.createElement(f.a,{style:{marginLeft:20,flex:1}},l.a.createElement(d.a,{style:{fontSize:20}},"Score"),l.a.createElement(T,{style:{marginVertical:10,alignSelf:"flex-end"}}),l.a.createElement(d.a,{style:{fontSize:20}},"Start Line"),l.a.createElement(T,{style:{marginVertical:10,alignSelf:"flex-end"}}),l.a.createElement(d.a,{style:{fontSize:20}},"Level"),l.a.createElement(T,{style:{marginVertical:10,alignSelf:"flex-end"}}),l.a.createElement(d.a,{style:{fontSize:20}},"Next"),l.a.createElement(W,{matrix:S,block:L({type:Oe,pos:[0,0]}),style:{borderWidth:0,marginVertical:10,alignSelf:"flex-end"}}))))),w&&P&&l.a.createElement(R.Widget,{title:(ve=null!=(t=null==se?void 0:se.username)?t:"no leader","Leader: "+ve),subtitle:(ye=x(_),0===ye.length?"No players":"Players: "+ye.join(", ")),handleNewUserMessage:function(e){if(!n)throw Error("No socket");n.emit(g.a.CHAT_MESSAGE,{username:P,message:e,roomName:w})}}))}},306:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(5),r=n.n(a),o=n(0),s=n.n(o),i=n(2),c=n(3),l=n(9),u=n(46),m=n(47),f=n(20),d=n(17),E=n(131),p=n(45),g=n(38);function b(e){var t=e.setScreenNumber,n=Object(o.useContext)(g.a),a=n.userContext,c=n.setUserContext,b=a.username,y=Object(o.useContext)(p.a),v=Object(f.useNavigation)(),C=Object(o.useState)(""),O=r()(C,2),S=O[0],R=O[1];return s.a.createElement(i.a,{style:{width:"100%",alignItems:"center"}},s.a.createElement(l.a,{style:h.title},"Username"),s.a.createElement(l.a,{style:h.error},S),s.a.createElement(m.a,{value:null!=b?b:"",onChangeText:function(e){R(""),c({username:e,room:void 0})},style:{borderWidth:1,marginBottom:20,height:30,width:"100%"}}),s.a.createElement(u.a,{style:h.button,onPress:function(){Object(E.b)(b).then((function(e){if(!0===e){if(!y)throw Error("No socket");y.emit(d.a.CREATE_USER,b),t(2)}})).catch((function(e){R(e.message)}))}},s.a.createElement(l.a,{style:h.linkText},"Next")),s.a.createElement(u.a,{style:h.button,onPress:function(){return v.push("Playground",{})}},s.a.createElement(l.a,{style:h.linkText},"Solo mode")))}var h=c.a.create({title:{marginBottom:5,alignSelf:"flex-start",textAlign:"center"},error:{marginBottom:5,alignSelf:"flex-start",textAlign:"center",color:"#980f0f"},linkText:{fontSize:14},button:{width:"70%",borderWidth:1,borderRadius:10,alignItems:"center",padding:3,marginBottom:30}});function y(e){var t=e.setScreenNumber,n=Object(o.useContext)(g.a),a=n.userContext,c=n.setUserContext,b=a.username,h=a.room,y=Object(o.useContext)(p.a),C=Object(f.useNavigation)(),O=Object(o.useState)(""),S=r()(O,2),R=S[0],w=S[1],P=Object(o.useState)([]),T=r()(P,2),x=T[0],k=T[1];console.log("Updates for waitingRooms:",x);var N=function(e){return k(e)},A=function(e){return k(e)};Object(o.useEffect)((function(){if(!y)throw Error("No socket");return y.emit(d.a.FETCH_WAITING_ROOMS),y.on(d.a.FETCH_WAITING_ROOMS,N),y.on(d.a.UPDATE_WAITING_ROOMS,A),function(){y.removeListener(d.a.FETCH_WAITING_ROOMS,N),y.removeListener(d.a.UPDATE_WAITING_ROOMS,A)}}),[]);return s.a.createElement(i.a,{style:{width:"100%",alignItems:"center"}},s.a.createElement(l.a,{style:{fontSize:16,marginBottom:50}},"Hello, ",b),s.a.createElement(l.a,{style:v.title},"Create room"),s.a.createElement(l.a,{style:v.error},R),s.a.createElement(m.a,{value:null!=h?h:"",onChangeText:function(e){w(""),c({username:b,room:e})},style:{borderWidth:1,marginBottom:20,height:30,width:"100%"}}),s.a.createElement(u.a,{style:v.button,onPress:function(){return function(e){Object(E.a)(e).then((function(n){if(!0===n){if(!y)throw Error("No socket");y.emit(d.a.CHOOSE_ROOM,{username:b,roomName:e}),b&&e&&C.push("Playground",{username:b,room:e}),t(1)}})).catch((function(e){w(e.message)}))}(h)}},s.a.createElement(l.a,{style:v.linkText},"Play")),s.a.createElement(i.a,{style:{width:"80%",marginTop:20}},x.length>0&&s.a.createElement(l.a,{style:v.title},"Join room"),x.length>0&&x.map((function(e){return s.a.createElement(i.a,{key:e},s.a.createElement(u.a,{style:v.roomsList,onPress:function(){return function(e){if(c({username:b,room:e}),!y)throw Error("No socket");y.emit(d.a.CHOOSE_ROOM,{username:b,roomName:e}),b&&e&&C.push("Playground",{username:b,room:e}),t(1)}(e)}},s.a.createElement(l.a,null,e)))}))))}var v=c.a.create({title:{marginBottom:5,alignSelf:"flex-start",textAlign:"center"},error:{marginBottom:5,alignSelf:"flex-start",textAlign:"center",color:"#980f0f"},linkText:{fontSize:14},roomsList:{borderWidth:1,borderRadius:5,margin:3,padding:2,alignItems:"center"},button:{width:"70%",borderWidth:1,borderRadius:10,alignItems:"center",padding:3,marginBottom:10}}),C=n(83);function O(){var e=Object(o.useState)(1),t=r()(e,2),n=t[0],a=t[1];return s.a.createElement(C.a,null,s.a.createElement(i.a,{style:{alignItems:"center",width:"60%"}},1===n?s.a.createElement(b,{setScreenNumber:a}):s.a.createElement(y,{setScreenNumber:a})))}},318:function(e,t,n){n(319),e.exports=n(425)},319:function(e,t){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/expo-service-worker.js",{scope:"/"}).then((function(e){})).catch((function(e){console.info("Failed to register service-worker",e)}))}))},32:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={left:37,rotate:38,right:39,down:40,space:32,sound:83,reset:82,pause:80}},377:function(e,t,n){e.exports=n.p+"static/media/sprite.81de6409.png"},38:function(e,t,n){"use strict";var a=n(0),r={username:void 0,room:void 0},o=Object(a.createContext)({userContext:r,setUserContext:function(){}});t.a=o},407:function(e,t){},45:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)(void 0);t.a=r},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(3),r=n(9),o=n(2),s=n(0),i=n.n(s),c=n(46),l=n(20),u=n(32),m=n(17),f=n(45),d=n(38),E=function(e){var t=e.size,n=e.color,a=e.label,s=e.style,l=e.onPress,u=e.disabled,m=e.text,f=i.a.useRef(null);return i.a.createElement(o.a,{style:[{alignItems:"center"},s]},i.a.createElement(c.a,{ref:f,disabled:u,onPress:function(){var e;null==f||null==(e=f.current)||e.blur(),null==l||l()},style:{backgroundColor:n,borderRadius:t/2,height:t,width:t,shadowColor:"rgba(0,0,0, .4)",shadowOffset:{height:1,width:1},shadowOpacity:20,shadowRadius:5,justifyContent:"center",alignItems:"center"}},m&&i.a.createElement(r.a,{style:{fontSize:25}},m)),a&&i.a.createElement(r.a,{style:{marginTop:10}},a))},p=function(e){var t=e.isPause,n=e.opponentsNumber,a=e.isLeader,r=e.disabled,c=e.isSoloMode,p=Object(s.useContext)(f.a),g=Object(s.useContext)(d.a),b=g.userContext,h=g.setUserContext,y=Object(l.useNavigation)(),v=a,C=!c&&(r||n<1),O=function(e){document.dispatchEvent(new KeyboardEvent("keydown",{keyCode:e,which:e}))};return i.a.createElement(o.a,{style:{width:400}},i.a.createElement(o.a,{style:{width:"100%"}},i.a.createElement(o.a,{style:{flexDirection:"row",marginVertical:20,justifyContent:"space-between"}},v&&i.a.createElement(E,{color:C?"#c0c0c0":"#2dc421",size:50,label:"Start",text:"\u25b6",disabled:C,onPress:function(){if(!p)throw Error("No socket");p.emit(m.a.START_GAME,{username:b.username,roomName:b.room})}}),i.a.createElement(E,{disabled:C,color:C?"#c0c0c0":"#2dc421",size:50,label:t?"Play(P)":"Pause(P)",onPress:function(){return O(u.a.pause)}}),i.a.createElement(E,{disabled:C,color:C?"#c0c0c0":"#2dc421",size:50,label:"Sound(S)",onPress:function(){return O(u.a.sound)}}),i.a.createElement(E,{disabled:C,color:C?"#c0c0c0":"#efcc19",size:50,label:"Reset(R)",onPress:function(){return O(u.a.reset)}}),i.a.createElement(E,{color:"white",size:50,style:{margin:0},label:"Exit",text:"\u2573",onPress:function(){if(!p)throw Error("No socket");h({username:void 0,room:void 0}),p.emit(m.a.PLAYER_LEFT,b.username),y.navigate("Root")}})),i.a.createElement(o.a,{style:{flexDirection:"row",alignItems:"center",marginTop:20}},i.a.createElement(o.a,{style:{marginRight:20}},i.a.createElement(E,{color:C?"#c0c0c0":"#5a65f1",size:160,label:"Drop(Space)",style:{marginTop:20},disabled:C||t,onPress:function(){return O(u.a.space)}})),i.a.createElement(o.a,{style:{marginLeft:20}},i.a.createElement(E,{color:C?"#c0c0c0":"#5a65f1",size:70,style:{margin:0},disabled:C||t,onPress:function(){return O(u.a.rotate)}}),i.a.createElement(o.a,{style:{flexDirection:"row"}},i.a.createElement(E,{color:C?"#c0c0c0":"#5a65f1",size:70,style:{margin:0,marginRight:60},disabled:C||t,onPress:function(){return O(u.a.left)}}),i.a.createElement(E,{color:C?"#c0c0c0":"#5a65f1",size:70,style:{margin:0},disabled:C||t,onPress:function(){return O(u.a.right)}})),i.a.createElement(E,{color:C?"#c0c0c0":"#5a65f1",size:70,style:{margin:0},disabled:C||t,onPress:function(){return O(u.a.down)}})))))},g=n(5),b=n.n(g),h=n(29),y=function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"window",t=s.useState((function(){return h.a.get(e)})),n=b()(t,2),a=n[0],r=n[1];return s.useEffect((function(){var t=!0,n=function(n){t&&r(n[e])};return h.a.addEventListener("change",n),function(){t=!1,h.a.removeEventListener("change",n)}}),[e,r]),a}("window")};function v(e){var t,n=e.children,a=e.isPause,c=e.roomPlayers,l=e.isLeader,u=e.gameover,m=e.isSoloMode,f=Object(s.useContext)(d.a).userContext,E=c&&0!==c.length?c.length-1:0,g=!(!f.username||!f.room),b=y(),h=b.width,v=b.height;t=v/h<1.5?v/960:h/560;var O=u;return i.a.createElement(o.a,{style:C.container},i.a.createElement(o.a,{style:[C.gameboy,{transform:[{scale:t}]}]},i.a.createElement(r.a,{style:C.title},"R E D \u25a0 T E T R I S"),i.a.createElement(o.a,{style:C.display},n,a?i.a.createElement(o.a,{style:[C.display,{position:"absolute",opacity:.8}]},function(e,t,n,a){return a?i.a.createElement(o.a,{style:{alignItems:"center"}},i.a.createElement(r.a,{style:C.gameover},"Game Over"),i.a.createElement(r.a,{style:C.gameMode},"Please wait for other players to finish")):e?i.a.createElement(o.a,{style:{alignItems:"center"}},i.a.createElement(r.a,{style:C.gameMode},"You are in multiplayer mode"),i.a.createElement(r.a,{style:C.gameMode},t," other player(s) in your room"),i.a.createElement(r.a,null,function(e,t){return e<=0?"Wait for other players":e>0&&t?"Press Start to begin":e>0&&!t?"Wait for leader to start the game":void 0}(t,n))):i.a.createElement(o.a,{style:{alignItems:"center"}},i.a.createElement(r.a,{style:C.gameMode},"You are in solo mode"),i.a.createElement(r.a,null,"Press Play(P) to start"))}(g,E,l,u)):null),i.a.createElement(p,{isPause:a,opponentsNumber:E,isLeader:l,disabled:O,isSoloMode:m})))}var C=a.a.create({container:{flex:1,backgroundColor:"#1f393e",alignItems:"center",justifyContent:"center",padding:20,height:"100%"},display:{alignItems:"center",backgroundColor:"#9ead86",borderBottomColor:"#fa6b6b",borderLeftColor:"#980f0f",borderRightColor:"#fa6b6b",borderTopColor:"#980f0f",borderWidth:5,height:500,justifyContent:"center",padding:10,width:400},gameboy:{justifyContent:"center",alignItems:"center",backgroundColor:"#990011",borderRadius:20,paddingBottom:30,paddingHorizontal:50},title:{fontSize:30,marginVertical:15,textAlign:"center"},gameMode:{marginBottom:20,fontSize:18},gameover:{marginBottom:20,fontWeight:"bold",color:"#990011",fontSize:24}})}},[[318,1,2]]]);
//# sourceMappingURL=app.d5d0dac4.chunk.js.map