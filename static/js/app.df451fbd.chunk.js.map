{"version":3,"sources":["src/config/constants.ts","src/client/screens/Login/utils.ts","src/client/constants/game.ts","App.tsx","src/client/navigation/index.tsx","src/client/screens/NotFoundScreen.tsx","src/client/screens/Ranking/index.tsx","src/client/navigation/LinkingConfiguration.ts","src/client/constants/tetriminos.ts","src/client/components/Digits/index.tsx","src/client/screens/Playground/utils.ts","src/client/components/Block/index.tsx","src/client/controllers/blockControllers.ts","src/client/components/Matrix/index.tsx","src/client/hooks/useKeyEvent/index.tsx","src/client/screens/Playground/index.tsx","src/client/screens/Login/ChooseUsername.tsx","src/client/screens/Login/ChooseRoom.tsx","src/client/screens/Login/index.tsx","web-build/register-service-worker.js","src/client/constants/keyboard.ts","assets/sprite.png","src/client/context/UserContext.ts","src/client/context/SocketContext.ts","src/client/components/Keypad/index.tsx","src/client/hooks/useWindowDimensions/index.ts","src/client/components/Gameboy/PreviewText.tsx","src/client/components/Gameboy/index.tsx"],"names":["SOCKETS","CREATE_USER","FETCH_CURRENT_PLAYER","CHOOSE_ROOM","ENTER_ROOM","UPDATE_ROOM_PLAYERS","PLAYER_LEFT","START_GAME","PAUSE_GAME","PENALTY_ROWS","UPDATE_SPECTRUM","FETCH_WAITING_ROOMS","UPDATE_WAITING_ROOMS","GAMEOVER","FETCH_ROOM_RANKING","UPDATE_SCORE","REDIRECT_TO_RANKING","CHAT_MESSAGE","FORBIDDEN","SCORING","ROW_DESTROYED","PIECE_PLACED","LAST_PLAYER","isEmpty","value","undefined","checkTextLength","text","length","checkSpecialChars","regexpr","RegExp","match","checkUsername","username","a","async","Error","axios","get","response","data","checkRoomName","roomName","name","isRoomPlayersLimitAvailable","players","maxPlayersLimit","App","window","addEventListener","e","keyCode","target","document","body","preventDefault","Navigation","colorScheme","linking","LinkingConfiguration","theme","DarkTheme","DefaultTheme","RootNavigator","Stack","createStackNavigator","useState","socket","setSocket","room","userContext","setUserContext","Provider","newSocket","io","getSocket","Navigator","screenOptions","headerShown","Screen","component","Login","Playground","Ranking","NotFoundScreen","options","title","navigation","style","styles","container","onPress","replace","link","linkText","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent","padding","fontSize","fontWeight","marginTop","paddingVertical","color","alignSelf","marginBottom","subtitle","tableContainer","width","flexDirection","tableHeader","tableContent","useContext","SocketContext","UserContext","params","useRoute","rankedRoomPlayers","setRoomPlayers","console","log","socketAccessForbidden","socketFetchRoomRanking","useEffect","emit","gameMode","on","removeListener","_","map","index","key","player","score","makeUrl","path","prefixes","Linking","config","screens","Root","NotFound","cellState","blockShape","I","L","J","Z","S","O","T","initialPos","blockTypes","fill","Array","OCCUPIED","blankLine","FREE","penaltyLine","BLOCKED","blankMatrix","blockMatrix","Digits","imageURI","Asset","fromModule","require","uri","View","val","ImageBackground","source","height","overflow","imageStyle","left","resizeMode","top","roomPlayersNames","outer","borderColor","borderWidth","outerSpectrum","inner","innerSpectrum","Block","isSpectrum","blockCreate","pos","shape","type","timeStamp","Date","now","blockRotate","block","result","row","reverse","blockFall","n","blockRight","blockLeft","blockGetBlockPos","positions","rowIndex","colIndex","push","isBlock","find","shapePos","isEqual","isBlockValid","matrix","hitBlock","col","rows","cols","min","right","max","bottom","blockGetCorner","printBlock","newMatrix","cloneDeep","size","Matrix","blockWidth","useKeyEvent","setIsPause","setMatrix","setBlock","useKey","_key","isWidgetOpened","keyboard","reset","sample","prevIsPause","prevMatrix","rotate","currentBlock","down","space","nextBlock","newState","blockDrop","useNavigation","roomPlayers","isPause","setCurrentPlayer","roomLeader","setRoomLeader","gameover","setGameover","gameStarted","setGameStarted","isSoloMode","socketChatMessage","message","addResponseMessage","socketFetchCurrentPlayer","socketUpdateRoomPlayers","newLeader","isLeader","prevCurrentPlayer","id","socketReceiveStartGame","tilesStack","startTile","socketReceivePauseGame","prevState","socketReceivePenaltyRows","rowsNumber","addPenaltyRows","socketReceiveRedirectToRanking","socketReceiveGameover","endGame","roomWinner","isWinner","socketEmitUpdatePlayerScore","socketReceiveUpdateSpectrum","dropMessages","leader","penaltyMatrix","slice","nextBlockType","useInterval","includes","socketEmitGameover","bottomMatrix","topMatrix","sum","deletedRows","destroyBlock","socketEmitPenaltyRows","spectrum","socketEmitUpdateSpectrum","j","flag","i","convertMatrixToSpectrum","Gameboy","Text","position","zIndex","marginLeft","currentPlayerUsername","filter","filteredOpponents","marginVertical","join","handleNewUserMessage","ChooseUsername","props","setScreenNumber","ussernameError","setUsernameError","error","TextInput","onChangeText","TouchableOpacity","button","then","catch","err","textAlign","borderRadius","ChooseRoom","roomNameError","setRoomNameError","joinRoomError","setJoinRoomError","waitingRooms","setWaitingRooms","handleFetchWaitingRooms","roomNames","handleUpdateWaitingRooms","onCreateRoomPress","waitingRoom","roomsList","onJoinRoomPress","margin","screenNumber","navigator","serviceWorker","register","scope","info","module","exports","createContext","RoundButton","label","disabled","React","useRef","ref","current","blur","shadowColor","shadowOffset","shadowOpacity","shadowRadius","Keypad","opponentsNumber","showStartButton","showPauseButton","isButtonDisabled","keyDown","dispatchEvent","KeyboardEvent","which","sound","navigate","marginRight","useWindowDimensions","dim","Dimensions","dimensions","setDimensions","stillCareAboutTheCallback","updateDimensions","nextDimensions","removeEventListener","useDimensionsSync","PreviewText","isMultiplayerMode","secondLineText","scale","children","w","h","isKeypadDisabled","gameboy","transform","display","opacity","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","paddingBottom","paddingHorizontal"],"mappings":"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","file":"static/js/app.df451fbd.chunk.js","sourcesContent":["export const SOCKETS = {\n  /* ---- User ---- */\n  CREATE_USER: 'create user',\n  FETCH_CURRENT_PLAYER: 'fetch current player',\n\n  /* ---- Room ---- */\n  CHOOSE_ROOM: 'create or join room',\n  ENTER_ROOM: 'enter room',\n  UPDATE_ROOM_PLAYERS: 'update room players',\n  PLAYER_LEFT: 'player left',\n  START_GAME: 'start game',\n  PAUSE_GAME: 'pause game',\n  PENALTY_ROWS: 'penalty rows',\n  UPDATE_SPECTRUM: 'update spectrum',\n  \n  /* ---- Game ---- */\n  FETCH_WAITING_ROOMS: 'fetch waiting rooms',\n  UPDATE_WAITING_ROOMS: 'update waiting rooms',\n  GAMEOVER: 'gameover',\n  FETCH_ROOM_RANKING: 'fetch room ranking',\n  UPDATE_SCORE: 'update score',\n  REDIRECT_TO_RANKING: 'redirect to ranking',\n  \n  /* ---- Chat ---- */\n  CHAT_MESSAGE: 'chat message',\n\n  /* ---- Error ---- */\n  FORBIDDEN: 'access forbidden',\n};\n\nexport const SCORING = {\n  ROW_DESTROYED: 10,\n  PIECE_PLACED: 4,\n  LAST_PLAYER: 200,\n};\n","import axios from 'axios';\n\nimport { maxPlayersLimit } from '/client/constants/game';\n\nexport const isEmpty = (value?: string | null): boolean => value === undefined || value === null || value === '';\n\nexport const checkTextLength = (text?: string | null): boolean => {\n  const maxLength = 15;\n  if (isEmpty(text)) return false;\n  if (text && text.length > maxLength) return false;\n  return true;\n};\n\nexport const checkSpecialChars = (text?: string | null): boolean => {\n  const regexpr =  new RegExp('\\\\W'); // matches any non-word-character, to only allow [a-zA-Z0-9_]\n  if (!text) return false;\n  if (text.match(regexpr)) return false;\n  return true;\n};\n\nexport const checkUsername = async (username: string | null | undefined): Promise<boolean> => {\n  if (!checkTextLength(username)) throw Error('Name must be 1-15 symbols');\n  if (!checkSpecialChars(username)) throw Error('Use letters and numbers');\n\n  const response = await axios.get(`${process.env.SERVER_URL}/player/${username}`);\n  if (response && isEmpty(response.data.username)) return(true);\n  throw Error('Username already taken');\n};\n\nexport const checkRoomName = async (roomName: string | null | undefined): Promise<boolean | undefined> => {\n  if (!checkTextLength(roomName)) throw Error('Name must be 1-15 symbols');\n  if (!checkSpecialChars(roomName)) throw Error('Use letters and numbers');\n\n  const response = await axios.get(`${process.env.SERVER_URL}/room/${roomName}`);\n  if (response && isEmpty(response.data.name)) return true;\n  throw Error('Room name already taken');\n};\n\n\nexport const isRoomPlayersLimitAvailable = async (roomName: string | null | undefined): Promise<boolean | undefined> => {\n  const response = await axios.get(`${process.env.SERVER_URL}/room/${roomName}`);\n  if (response && response.data.players.length >= maxPlayersLimit)\n    throw Error('Too many players in the room');\n  return true;\n};\n","export const maxPlayersLimit = 4;\n","import { StatusBar } from 'expo-status-bar';\nimport React from 'react';\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\n\nimport Navigation from './src/client/navigation';\n\nexport default function App(): JSX.Element | null {\n  // Prevent window from scrolling on Space button click\n  window.addEventListener('keydown', function(e) {\n    if(e.keyCode === 32 && e.target == document.body) {\n      e.preventDefault();\n    }\n  });\n\n  return (\n    <SafeAreaProvider>\n      <Navigation />\n      <StatusBar />\n    </SafeAreaProvider>\n  );\n}\n","import { NavigationContainer, DefaultTheme, DarkTheme } from '@react-navigation/native';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport React, { useState } from 'react';\nimport { ColorSchemeName } from 'react-native';\n\nimport NotFoundScreen from '/client/screens/NotFoundScreen';\nimport Login from '/client/screens/Login';\nimport Playground from '/client/screens/Playground';\nimport Ranking from '/client/screens/Ranking';\nimport LinkingConfiguration from '/client/navigation/LinkingConfiguration';\nimport io from 'socket.io-client';\nimport SocketContext from '/client/context/SocketContext';\nimport UserContext from '/client/context/UserContext';\n\n// If you are not familiar with React Navigation, we recommend going through the\n// \"Fundamentals\" guide: https://reactnavigation.org/docs/getting-started\nexport default function Navigation({ colorScheme }: { colorScheme?: ColorSchemeName }): JSX.Element {\n  return (\n    <NavigationContainer\n      linking={LinkingConfiguration}\n      theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\n      <RootNavigator />\n    </NavigationContainer>\n  );\n}\n\n// A root stack navigator is often used for displaying modals on top of all other content\n// Read more here: https://reactnavigation.org/docs/modal\nconst Stack = createStackNavigator<RootStackParamList>();\n\nfunction RootNavigator() {\n  const [socket, setSocket] = useState<undefined | SocketIOClient.Socket>(undefined);\n\n  const getSocket = () => {\n    if (socket) {\n      return socket;\n    }\n    const newSocket = io(`${process.env.SERVER_URL}`);\n    setSocket(newSocket);\n    return newSocket;\n  };\n  \n  const [userContext, setUserContext] = useState<UserContextType>({username: undefined, room: undefined});\n\n  return (\n    <SocketContext.Provider value={getSocket()} >\n      <UserContext.Provider value={{userContext, setUserContext}} >\n        <Stack.Navigator screenOptions={{ headerShown: false }}>\n          <Stack.Screen name=\"Root\" component={Login} />\n          <Stack.Screen name=\"Playground\" component={Playground} />\n          <Stack.Screen name=\"Ranking\" component={Ranking} />\n          <Stack.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\n        </Stack.Navigator>\n      </UserContext.Provider>\n    </SocketContext.Provider>\n  );\n}\n","import { StackScreenProps } from '@react-navigation/stack';\nimport * as React from 'react';\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\n\nexport default function NotFoundScreen({\n  navigation,\n}: StackScreenProps<RootStackParamList, 'NotFound'>): JSX.Element {\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>{'This screen doesn\\'t exist.'}</Text>\n      <TouchableOpacity onPress={() => navigation.replace('Root')} style={styles.link}>\n        <Text style={styles.linkText}>Go to home screen!</Text>\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 20,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  link: {\n    marginTop: 15,\n    paddingVertical: 15,\n  },\n  linkText: {\n    fontSize: 14,\n    color: '#2e78b7',\n  },\n});\n","import  React, { useState, useEffect, useContext } from 'react';\nimport _ from 'lodash';\nimport { StyleSheet, View, Text } from 'react-native';\nimport { useRoute, RouteProp } from '@react-navigation/native';\n\nimport Gameboy from '/client/components/Gameboy';\nimport { SOCKETS } from '/config/constants';\nimport SocketContext from '/client/context/SocketContext';\nimport UserContext from '/client/context/UserContext';\n\nconst Ranking = (): JSX.Element => {\n  const socket = useContext(SocketContext);\n  const { userContext, setUserContext } = useContext(UserContext);\n\n  const route = useRoute<RouteProp<RootStackParamList, 'Ranking'>>();\n  const { params } = route;\n  // const { room, username } = userContext;\n  const { room, username } = params ?? {};\n  const [rankedRoomPlayers, setRoomPlayers] = useState<PlayerType[]>([]);\n\n  console.log('roomPlayers:', rankedRoomPlayers);\n\n  const socketAccessForbidden = () => {\n    console.log('aaaaaaaaaaaa forbidden');\n  };\n\n  const socketFetchRoomRanking = (players: PlayerType[]) => {\n    setRoomPlayers(players);\n  };\n\n\n  useEffect(() => {\n    if (!socket) throw Error('No socket');\n    // TODO: Here I tested how I can forbid access to pages that I entered fom URL but sis not create. Uncomment it at the end of development\n    // socket.emit(SOCKETS.FETCH_ROOM_RANKING, {username, roomName: room, gameMode: 'not solo'});\n    socket.emit(SOCKETS.FETCH_ROOM_RANKING, {username, roomName: room, gameMode: 'not solo'});\n    socket.on(SOCKETS.FORBIDDEN, socketAccessForbidden);\n    socket.on(SOCKETS.FETCH_ROOM_RANKING, socketFetchRoomRanking);\n\n    return () => {\n      socket.removeListener(SOCKETS.FORBIDDEN, socketAccessForbidden);\n      socket.removeListener(SOCKETS.FETCH_ROOM_RANKING, socketFetchRoomRanking);\n    };\n  }, []);\n\n  return (\n    <Gameboy>\n      <View style={{ justifyContent: 'space-between' }}>\n        <Text style={styles.title}>Game report</Text>\n        {username && rankedRoomPlayers[0] && (username === rankedRoomPlayers[0].username)\n          ? <Text style={styles.subtitle}>{username}, you are the winner!</Text>\n          : <Text style={styles.subtitle}>{username} @ {room}</Text>\n        }\n        <View style={styles.tableContainer}>\n          <View>\n            <Text style={styles.tableHeader}>Place</Text>\n            {_.map(rankedRoomPlayers, (_, index) =>\n              <Text key={index} style={styles.tableContent}>{index + 1}</Text>)}\n          </View>\n          <View>\n            <Text style={styles.tableHeader}>Name</Text>\n            {_.map(rankedRoomPlayers, (player, index) =>\n              <Text key={index} style={styles.tableContent}>{player.username}</Text>)}\n          </View>\n          <View>\n            <Text style={styles.tableHeader}>Score</Text>\n            {_.map(rankedRoomPlayers, (player, index) =>\n              <Text key={index} style={styles.tableContent}>{player.score}</Text>)}\n          </View>\n        </View>\n      </View>\n    </Gameboy>\n  );\n};\n\nconst styles = StyleSheet.create({\n  title: {\n    fontSize: 26,\n    fontWeight: 'bold',\n    alignSelf: 'center',\n    marginBottom: '10%',\n  },\n  subtitle: {\n    fontSize: 24,\n    alignSelf: 'center',\n    marginBottom: '10%',\n  },\n  tableContainer: {\n    width: 300,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n  tableHeader: {\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  tableContent: {\n    fontSize: 18,\n    marginBottom: 3,\n    marginTop: 3,\n  },\n});\n\nexport default Ranking;\n","import * as Linking from 'expo-linking';\n\nconst makeUrl = (path: string) => `${process.env.PUBLIC_URL}/${path}`;\n\nexport default {\n  prefixes: [Linking.makeUrl(process.env.PUBLIC_URL)],\n  config: {\n    screens: {\n      Root: makeUrl('/'),\n      Playground: makeUrl('/play'),\n      Ranking: makeUrl('/ranking'),\n      NotFound: '*',\n    },\n  },\n};\n\n// console.log(`${process.env.PUBLIC_URL}/`)\n// console.log(\"THIS IS THE LATEST VERSION 5\")","import _ from 'lodash';\n\nexport const blockShape = {\n  I: [\n    [0, 0, 0, 0],\n    [1, 1, 1, 1],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n  ],\n  L: [\n    [0, 0, 1],\n    [1, 1, 1],\n    [0, 0, 0],\n  ],\n  J: [\n    [1, 0, 0],\n    [1, 1, 1],\n    [0, 0, 0],\n  ],\n  Z: [\n    [1, 1, 0],\n    [0, 1, 1],\n    [0, 0, 0],\n  ],\n  S: [\n    [0, 1, 1],\n    [1, 1, 0],\n    [0, 0, 0],\n  ],\n  O: [\n    [1, 1],\n    [1, 1],\n  ],\n  T: [\n    [0, 1, 0],\n    [1, 1, 1],\n    [0, 0, 0],\n  ],\n};\n\nexport const initialPos = {\n  I: [-2, 3],\n  L: [-2, 4],\n  J: [-2, 4],\n  Z: [-2, 4],\n  S: [-2, 4],\n  O: [-2, 4],\n  T: [-2, 4],\n};\n\nexport const blockTypes: TetriminosType[] = ['I','L','J','Z','S','O', 'T'];\n\nexport const speeds = [800, 650, 500, 370, 250, 160];\n\nexport const delays = [50, 60, 70, 80, 90, 100];\n\nexport enum cellState {\n  FREE,\n  OCCUPIED,\n  BLOCKED,\n}\n\nexport const fillLine = _.fill(Array(10), cellState.OCCUPIED); // never used\n\nexport const blankLine = _.fill(Array(10), cellState.FREE);\n\nexport const penaltyLine = _.fill(Array(10), cellState.BLOCKED);\n\nexport const blankMatrix: Matrix = _.map(Array(20), () => _.fill(Array(10), cellState.FREE));\n\nexport const blockMatrix: Matrix = _.map(Array(2), () => _.fill(Array(4), cellState.FREE));\n","import _ from 'lodash';\nimport { Asset } from 'expo-asset';\nimport { ImageBackground, View, ViewStyle } from 'react-native';\nimport * as React from 'react';\n\nexport default function Digits({ style }: { style?: ViewStyle }): JSX.Element {\n  // eslint-disable-next-line @typescript-eslint/no-var-requires\n  const imageURI = Asset.fromModule(require('../../../../assets/sprite.png')).uri;\n  return (\n    <View style={[{ flexDirection: 'row' }, style]} >\n      {_.map(Array(6), (val, index: number) => <ImageBackground\n        key={index}\n        source={{ uri: imageURI }}\n        style={{ width: 14, height: 24, overflow: 'hidden' }}\n        imageStyle={{\n          height: 186,\n          left: -215,\n          resizeMode: 'cover',\n          top: -25,\n          width: 400,\n        }}\n      />)}\n    </View>\n  );\n}\n","import _ from 'lodash';\n\nimport { cellState } from '/client/constants/tetriminos';\n\nconst formatChatTitle = (leader: string): string => {\n  return `Leader: ${leader}`;\n};\n\nconst formatChatSubtitle = (players: string[]): string => {\n  if (players.length === 0) return 'No players';\n  return `Players: ${players.join(', ')}`;\n};\n\nconst roomPlayersNames = (players?: PlayerType[]): string[] => {\n  if (!players || players.length === 0) return [];\n  const namesArray = players.map((player) => player.username);\n  return namesArray;\n};\n\nconst convertMatrixToSpectrum = (matrix: Matrix): Matrix => {\n  const result = _.cloneDeep(matrix);\n  for (let j = 0; j < matrix[0].length; j++) {\n    let flag = false;\n    for (let i = 0; i < matrix.length; i++) {\n      if (matrix[i][j] === cellState.OCCUPIED)\n        flag = true;\n      if (flag)\n        result[i][j] = cellState.OCCUPIED;\n    }\n  }\n  return result;\n};\n\n// const rowFillWithOccupied = (row: number[]): number[] => {\n//   const index = _.indexOf(row, cellState.OCCUPIED);\n//   if (index === -1) return row;\n//   return(_.fill(row, cellState.OCCUPIED, index));\n// };\n\n// const transposeMatrix = (matrix: Matrix): Matrix => {\n//   const result = [];\n//   for (let i = 0; i < matrix[0].length; i++) {\n//     result.push([]);\n//     for (let j = 0; j < matrix.length; j++) {\n//       result[i].push(matrix[j][i]);\n//     }\n//   }\n//   return(result);\n// };\n\n// const fillSpectrum = (matrix: Matrix): Matrix => {\n//   const transposedMatrix = transposeMatrix(matrix);\n//   const transposedFilled = _.map(transposedMatrix, (array) => rowFillWithOccupied(array));\n//   return transposeMatrix(transposedFilled);\n// };\n\nexport { formatChatSubtitle, formatChatTitle, roomPlayersNames, convertMatrixToSpectrum };\n","import { StyleSheet, View } from 'react-native';\nimport * as React from 'react';\n\nimport { cellState } from '/client/constants/tetriminos';\n\nconst styles = StyleSheet.create({\n  outer: {\n    alignItems: 'center',\n    borderColor: '#879372',\n    borderWidth: 1,\n    height: 20,\n    justifyContent: 'center',\n    width: 20,\n  },\n  outerSpectrum: {\n    alignItems: 'center',\n    borderColor: '#879372',\n    borderWidth: 1,\n    height: 6,\n    justifyContent: 'center',\n    width: 6,\n  },\n  inner: {\n    height: 12,\n    width: 12,\n    backgroundColor: '#879372',\n  },\n  innerSpectrum: {\n    height: 2,\n    width: 2,\n    backgroundColor: '#879372',\n  },\n});\n\nconst Block = ({ value, isSpectrum }: { value: CellStateType | number, isSpectrum?: boolean }): JSX.Element => {\n  return (\n    isSpectrum\n      ?\n      <View style={[styles.outerSpectrum, value === cellState.OCCUPIED ? { borderColor: 'black' } : (value === cellState.BLOCKED ? { borderColor: 'black'} : undefined)]}>\n        <View style={[styles.innerSpectrum, value === cellState.OCCUPIED ? { backgroundColor: 'black' } : (value === cellState.BLOCKED ? { backgroundColor: 'transparent'} : undefined)]} />\n      </View>\n      :\n      <View style={[styles.outer, value === cellState.OCCUPIED ? { borderColor: 'black' } : (value === cellState.BLOCKED ? { borderColor: 'black'} : undefined)]}>\n        <View style={[styles.inner, value === cellState.OCCUPIED ? { backgroundColor: 'black' } : (value === cellState.BLOCKED ? { backgroundColor: 'transparent'} : undefined)]} />\n      </View>\n  );\n};\n\nexport default Block;\n","import _ from 'lodash';\n\nimport { blockShape, initialPos, blankLine, cellState } from '/client/constants/tetriminos';\n\nconst blockCreate = ({pos, shape, type, timeStamp}: BlockOption): BlockType => {\n  return {\n    pos: pos ?? initialPos[type],\n    shape: shape ?? blockShape[type],\n    type: type,\n    timeStamp: timeStamp ?? Date.now(),\n  };\n};\n\nconst blockRotate = (block: BlockType): BlockType => {\n  const shape = block.shape;\n  const result: number[][] = shape[0].map((val, index) => shape.map(row => row[index]).reverse());\n\n  return {\n    pos: block.pos,\n    shape: result,\n    type: block.type,\n    timeStamp: block.timeStamp,\n  };\n};\n\nconst blockFall = (block: BlockType, n = 1): BlockType => {\n  return {\n    pos: [block.pos[0] + n, block.pos[1]],\n    shape: block.shape,\n    type: block.type,\n    timeStamp: block.timeStamp,\n  };\n};\n\nconst blockRight = (block: BlockType): BlockType => {\n  return {\n    pos: [block.pos[0], block.pos[1] + 1],\n    shape: block.shape,\n    type: block.type,\n    timeStamp: block.timeStamp,\n  };\n};\n\nconst blockLeft = (block: BlockType): BlockType => {\n  return {\n    pos: [block.pos[0], block.pos[1] - 1],\n    shape: block.shape,\n    type: block.type,\n    timeStamp: block.timeStamp,\n  };\n};\n\nconst blockDrop = (block: BlockType, matrix: Matrix): BlockType => {\n  let newState = blockCreate({ type: block.type, pos: block.pos, shape: block.shape });\n\n  while (isBlockValid(blockFall(newState), matrix)) { \n    newState = blockFall(newState);\n  }\n  return newState;  \n};\n\nconst blockGetBlockPos = (block: BlockType): number[][] => {\n  const positions: number[][] = [];\n  _.map(block.shape, (row, rowIndex) =>\n    _.map(row, (val, colIndex) => { \n      if (val) positions.push([rowIndex + block.pos[0], colIndex + block.pos[1]]);\n    }));\n  return positions;\n};\n\nconst blockGetCorner = (block: BlockType): { left: number, top: number, right: number, bottom: number } => { \n  const rows = _.map(blockGetBlockPos(block), ([row]) => row);\n  const cols = _.map(blockGetBlockPos(block), ([, col]) => col);\n  return {\n    left: _.min(cols) ?? 0,\n    top: _.min(rows) ?? 0,\n    right: _.max(cols) ?? 0,\n    bottom: _.max(rows) ?? 0,\n  };\n};\n\nconst isBlock = (block: BlockType, pos: number[]): boolean => { \n  return _.find(blockGetBlockPos(block), (shapePos) => _.isEqual(shapePos, pos)) !== undefined;\n};\n\nconst isBlockValid = (block: BlockType, matrix: Matrix): boolean => { \n  const hitBlock = _.find(blockGetBlockPos(block), ([row, col]) => matrix?.[row]?.[col] === cellState.BLOCKED || matrix?.[row]?.[col] === cellState.OCCUPIED);\n  const { left, right, bottom } = blockGetCorner(block);\n  return bottom < 20\n    && left >= 0\n    && right < 10\n    && !hitBlock;\n};\n\nconst printBlock = (block: BlockType, matrix: Matrix): Matrix => { \n  const newMatrix = _.cloneDeep(matrix);\n  _.map(blockGetBlockPos(block), (pos) => {\n    if (pos[0] >= 0 && pos[0] < _.size(newMatrix)\n      && pos[1] >= 0 && pos[1] < _.size(newMatrix[0])) {\n      newMatrix[pos[0]][pos[1]] = cellState.OCCUPIED;\n    }\n  });\n  return newMatrix;\n};\n\nconst destroyBlock = (matrix: Matrix): { newMatrix: Matrix, deletedRows: number} => {\n  let bottomMatrix: Matrix = [];\n  let topMatrix: Matrix = [];\n  _.map(matrix, (row) => {\n    // Row sum = 10 when row is complete (cellState.OCCUPIED);\n    // Row sum > 10 (row sum = 20) when there is a penalty row (because penalty row consists of cellState.BLOCKED = 2)\n    if (_.sum(row) < 10 || _.sum(row) > 10) {\n      bottomMatrix = _.cloneDeep([...bottomMatrix, row]);\n      // TODO: We can send SOCKETS.SPECTER_UPDATE here when bottomMatrix.length === 20\n    } else {\n      topMatrix = _.cloneDeep([...topMatrix, blankLine]);\n    }\n  });\n  console.log('Destroy', _.cloneDeep([...topMatrix, ...bottomMatrix])); // TODO: rm\n  return ({ newMatrix: _.cloneDeep([...topMatrix, ...bottomMatrix]), deletedRows: topMatrix.length });\n};\n\nexport { \n  blockCreate,\n  blockRotate,\n  blockFall,\n  blockRight,\n  blockLeft,\n  blockDrop,\n  blockGetBlockPos,\n  blockGetCorner,\n  isBlock,\n  isBlockValid,\n  printBlock,\n  destroyBlock,\n};\n","import _ from 'lodash';\nimport { View, ViewStyle, StyleSheet } from 'react-native';\nimport * as React from 'react';\n\nimport BlockComponent from '/client/components/Block';\nimport { isBlock } from '/client/controllers/blockControllers';\nimport { cellState } from '/client/constants/tetriminos';\n\n\nconst Matrix = ({ block, matrix, style, isSpectrum }: { block: BlockType, matrix: Matrix, style?: ViewStyle, isSpectrum?:boolean }): JSX.Element => {\n  const blockWidth = isSpectrum ? 8 : 22;\n  return (\n    <View style={[styles.container, { height: _.size(matrix) * blockWidth }, style]}>\n      {_.map(matrix, (row, rowIndex) =>\n        <View key={rowIndex} style={{ flexDirection: 'row', width: _.size(row) * blockWidth, justifyContent: 'space-between' }}>\n          {_.map(row, (value, colIndex) => <BlockComponent key={colIndex} isSpectrum={isSpectrum} value={isBlock(block, [rowIndex, colIndex]) ? cellState.OCCUPIED : value} />)}\n        </View>)}\n    </View>\n  );\n};\n\nexport default Matrix;\n\nconst styles = StyleSheet.create({\n  container: {\n    padding: 2, justifyContent: 'space-between', borderColor: 'black', borderWidth: 1, backgroundColor: '#9ead86',\n  },\n});\n   ","import { Dispatch, SetStateAction } from 'react';\nimport useKey from 'use-key-hook';\nimport _ from 'lodash';\nimport { isWidgetOpened } from '/client/components/Chat';\n\nimport { blankMatrix } from '/client/constants/tetriminos';\nimport { blockTypes } from '/client/constants/tetriminos';\nimport { keyboard } from '/client/constants/keyboard';\nimport {\n  blockCreate,\n  blockRotate,\n  blockFall,\n  blockRight,\n  blockLeft,\n  blockDrop,\n  isBlockValid,\n  printBlock,\n} from '/client/controllers/blockControllers';\n\nexport const useKeyEvent = ({ setIsPause, setMatrix, setBlock }\n  : {\n    setIsPause: Dispatch<SetStateAction<boolean>>,\n    setMatrix: Dispatch<SetStateAction<Matrix>>,\n    setBlock: Dispatch<SetStateAction<BlockType>>,\n  }): void => {\n  useKey((_key: number, { keyCode }: { keyCode: number }) => {\n    // When Chat widget is opened, key press should not affect movement on Matrix Playground\n    if (isWidgetOpened()) return;\n    if (keyCode === keyboard.reset) {\n      setBlock(blockCreate({ type: _.sample(blockTypes) ?? 'T' }));\n      setMatrix(blankMatrix);\n      setIsPause(true);\n    }\n    setIsPause((prevIsPause) => {\n      setMatrix((prevMatrix) => {\n        if (!prevIsPause) {\n          if (keyCode === keyboard.rotate) {\n            setBlock((currentBlock) => isBlockValid(blockRotate(currentBlock), prevMatrix) ? blockRotate(currentBlock) : currentBlock);\n          }\n          if (keyCode === keyboard.left) {\n            setBlock((currentBlock) => isBlockValid(blockLeft(currentBlock), prevMatrix) ? blockLeft(currentBlock) : currentBlock);\n          }\n          if (keyCode === keyboard.right) {\n            setBlock((currentBlock) => isBlockValid(blockRight(currentBlock), prevMatrix) ? blockRight(currentBlock) : currentBlock);\n          }\n          if (keyCode === keyboard.down) {\n            setBlock((currentBlock) => {\n              if (isBlockValid(blockFall(currentBlock), prevMatrix)) return blockFall(currentBlock);\n              else {\n                setMatrix(printBlock(currentBlock, prevMatrix));\n                return currentBlock;\n              }\n            });\n          }\n          if (keyCode === keyboard.space) {\n            setBlock((currentBlock) => {\n              const nextBlock = blockDrop(currentBlock, prevMatrix);\n              setMatrix(printBlock(nextBlock, prevMatrix));\n              return nextBlock;\n            });\n          }\n        }\n        return prevMatrix;\n      });\n      return prevIsPause;\n    });\n  });\n};\n","import  React, { useState, useEffect, useContext } from 'react';\nimport _ from 'lodash';\nimport { View, Text } from 'react-native';\nimport useInterval from '@use-it/interval';\nimport { useRoute, RouteProp } from '@react-navigation/native';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { SOCKETS, SCORING } from '/config/constants';\nimport { blankMatrix, blockMatrix, penaltyLine } from '/client/constants/tetriminos';\nimport { blockTypes } from '/client/constants/tetriminos';\nimport { ChatWidget, addResponseMessage, dropMessages } from '/client/components/Chat';\nimport Digits from '/client/components/Digits';\nimport { formatChatSubtitle, formatChatTitle, roomPlayersNames, convertMatrixToSpectrum } from '/client/screens/Playground/utils';\nimport Gameboy from '/client/components/Gameboy';\nimport Matrix from '/client/components/Matrix';\nimport { useKeyEvent } from '/client/hooks/useKeyEvent';\nimport SocketContext from '/client/context/SocketContext';\nimport UserContext from '/client/context/UserContext';\nimport { blockCreate, blockFall, isBlockValid, printBlock, destroyBlock } from '/client/controllers/blockControllers';\n\nexport default function Playground(): JSX.Element {\n  const socket = useContext(SocketContext);\n  const { userContext, setUserContext } = useContext(UserContext);\n  const navigation = useNavigation<StackNavigationProp<RootStackParamList, 'Root'>>();\n\n  const route = useRoute<RouteProp<RootStackParamList, 'Playground'>>();\n  const { params } = route;\n  // const { room, username } = userContext;\n  const { room, username } = params ?? {};\n  const [roomPlayers, setRoomPlayers] = useState<PlayerType[]>([]);\n  const [block, setBlock] = useState<BlockType>(blockCreate({ type: _.sample(blockTypes) ?? 'T' }));\n  const [matrix, setMatrix] = useState<Matrix>(blankMatrix);\n  const [isPause, setIsPause] = useState<boolean>(true);\n  const [player, setCurrentPlayer] = useState<PlayerType>();\n  const [roomLeader, setRoomLeader] = useState<PlayerType>();\n  const [gameover, setGameover] = useState<boolean>(false);\n  const [gameStarted, setGameStarted] = useState<boolean>(false);\n  //If there are no URL params, then it's solo mode\n  const isSoloMode = !room || !username;\n\n  const filteredOpponents = (roomPlayers: PlayerType[], currentPlayerUsername: string) => {\n    return _.filter(roomPlayers, (player) => player.username !== currentPlayerUsername);\n  };\n\n  useKeyEvent({ setBlock, setMatrix, setIsPause });\n\n  const socketChatMessage = (message: Message) => {\n    addResponseMessage(message.username + ': ' + message.text, message.username);\n  };\n  \n  const socketFetchCurrentPlayer = (player: PlayerType) => {\n    setCurrentPlayer(player);\n    console.log('FETCH_CURRENT_PLAYER', player); // TODO: use player.isLeader to show/hide tetris buttons\n  };\n\n  const socketUpdateRoomPlayers = (data: { room: string, players: PlayerType[] }) => {\n    setRoomPlayers(data.players);\n    \n    // When old leader leaves the room, we set a new leader\n    // And if new room leader and this room player are the same user, we update isLeader in player (or update the whole player)\n    const newLeader = _.find(data.players, (player) => player.isLeader);\n    setRoomLeader(newLeader);\n    setCurrentPlayer((prevCurrentPlayer) => {\n      if (prevCurrentPlayer && newLeader && prevCurrentPlayer.id === newLeader.id) {\n        return newLeader;\n      }\n      return prevCurrentPlayer;\n    });\n  };\n\n  const socketReceiveStartGame = ({ tilesStack, startTile }: { tilesStack: string[], startTile: string }) => {\n    // TODO: assign tile stack here\n    console.log('START_GAME', startTile, tilesStack, isPause);\n    setGameStarted(true);\n    setIsPause(false);\n  };\n\n  const socketReceivePauseGame = () => {\n    setIsPause(prevState => !prevState);\n  };\n\n  const socketEmitPenaltyRows = (rowsNumber: number) => {\n    if (!socket) throw Error('No socket');\n    console.log('PENALTY_ROWS emit, rowsNumber:', rowsNumber);\n    socket.emit(SOCKETS.PENALTY_ROWS, { username, roomName: room, rowsNumber });\n  };\n\n  const socketReceivePenaltyRows = (rowsNumber: number) => {\n    setMatrix((prevMatrix) => {\n      const newMatrix = addPenaltyRows(prevMatrix, rowsNumber);\n      console.log('PENALTY_ROWS receive. rowsNumber, newMatrix:', rowsNumber, newMatrix);\n      return newMatrix;\n    });\n  };\n  \n  const socketEmitUpdatePlayerScore = () => {\n    if (!socket) throw Error('No socket');\n\n    setCurrentPlayer((prevCurrentPlayer) => {\n      if (!prevCurrentPlayer) return;\n      socket.emit(SOCKETS.UPDATE_SCORE, { username: prevCurrentPlayer.username, roomName: prevCurrentPlayer.room, score: prevCurrentPlayer.score });\n      return prevCurrentPlayer;\n    });\n  };\n\n  const socketReceiveRedirectToRanking = () => {\n    navigation.push('Ranking', { username, room });\n  };\n\n  const socketEmitGameover = () => {\n    if (!socket) throw Error('No socket');\n    socket.emit(SOCKETS.GAMEOVER, { username: userContext.username, roomName: userContext.room });\n  };\n\n  const socketReceiveGameover = ({ players, endGame }: { players: PlayerType[], endGame: boolean }) => {\n    const roomWinner = _.find(players, (player) => player.isWinner);\n\n    setCurrentPlayer((prevCurrentPlayer) => {\n      if (prevCurrentPlayer && roomWinner && roomWinner.username === prevCurrentPlayer.username) {\n        const playerWithUpdatedScore = { ...prevCurrentPlayer, score: prevCurrentPlayer.score + SCORING.LAST_PLAYER };\n        return playerWithUpdatedScore;\n      }\n      return prevCurrentPlayer;\n    });\n\n    if (endGame) {\n      socketEmitUpdatePlayerScore();\n      setIsPause(true);\n      setGameover(true);\n    }\n  };\n\n  const socketEmitUpdateSpectrum = (spectrum: Matrix) => {\n    if (!socket) throw Error('No socket');\n    socket.emit(SOCKETS.UPDATE_SPECTRUM, { username: userContext.username, roomName: userContext.room, spectrum });\n  };\n\n  const socketReceiveUpdateSpectrum = (roomPlayers: PlayerType[]) => {\n    console.log('SOCKET.UPDATE_SPECTRUM, roomPlayers', roomPlayers);\n    setRoomPlayers(roomPlayers);\n  };\n\n  useEffect(() => {\n    dropMessages();\n    /*\n    ** TODO: del next line when tmp SOCKETS.ENTER_ROOM by url params is deleted\n    */\n    setUserContext({ username, room }); // for components that use UserContext\n    console.log('Playground, User context:', userContext);\n    if (!socket) throw Error('No socket');\n    /*\n    ** TODO: uncomment when tmp SOCKETS.ENTER_ROOM by url params is deleted\n    */\n    // if (userContext.username && userContext.room) // If not solo mode, enter room\n    socket.emit(SOCKETS.ENTER_ROOM, { username, roomName: room });\n\n    // Message from server\n    socket.on(SOCKETS.CHAT_MESSAGE, socketChatMessage);\n\n    // Current player sent from server\n    socket.on(SOCKETS.FETCH_CURRENT_PLAYER, socketFetchCurrentPlayer);\n\n    // When new players join the room\n    socket.on(SOCKETS.UPDATE_ROOM_PLAYERS, socketUpdateRoomPlayers);\n\n    // Receive block type and stack of 3 next blocks\n    socket.on(SOCKETS.START_GAME, socketReceiveStartGame);\n\n    // Pause playgound matrix\n    socket.on(SOCKETS.PAUSE_GAME, socketReceivePauseGame);\n\n    // Receive penalty rows\n    socket.on(SOCKETS.PENALTY_ROWS, socketReceivePenaltyRows);\n\n    // One of opponents has gameover\n    socket.on(SOCKETS.GAMEOVER, socketReceiveGameover);\n\n    // One of opponents updated his spectrum\n    socket.on(SOCKETS.UPDATE_SPECTRUM, socketReceiveUpdateSpectrum);\n\n    // Redirect player to ranking page after player.isWinner score was updated\n    socket.on(SOCKETS.REDIRECT_TO_RANKING, socketReceiveRedirectToRanking);\n  \n    return () => {\n      socket.emit(SOCKETS.PLAYER_LEFT, username);\n\n      socket.removeListener(SOCKETS.CHAT_MESSAGE, socketChatMessage);\n      socket.removeListener(SOCKETS.FETCH_CURRENT_PLAYER, socketFetchCurrentPlayer);\n      socket.removeListener(SOCKETS.UPDATE_ROOM_PLAYERS, socketUpdateRoomPlayers);\n      socket.removeListener(SOCKETS.START_GAME, socketReceivePauseGame);\n      socket.removeListener(SOCKETS.PAUSE_GAME, socketReceiveStartGame);\n      socket.removeListener(SOCKETS.PENALTY_ROWS, socketReceivePenaltyRows);\n      socket.removeListener(SOCKETS.GAMEOVER, socketReceiveGameover);\n      socket.removeListener(SOCKETS.UPDATE_SPECTRUM, socketReceiveUpdateSpectrum);\n      socket.removeListener(SOCKETS.REDIRECT_TO_RANKING, socketReceiveRedirectToRanking);\n      dropMessages();\n    };\n  }, []);\n\n  const handleNewUserMessage = (message: string) => {\n    if (!socket) throw Error('No socket');\n    socket.emit(SOCKETS.CHAT_MESSAGE, { username, message, roomName: room });\n  };\n\n  const addPenaltyRows = (matrix: Matrix, rowsNumber: number): Matrix => {\n    // Create array of blank lines\n    const penaltyMatrix = Array(rowsNumber).fill(penaltyLine);\n    // Add it to the bottom of matrix (matrix has 20 + rowsNumber lines)\n    const newMatrix = _.cloneDeep([...matrix, ...penaltyMatrix]);\n    // Return matrix without N start lines (matrix has 20 lines again)\n    return _.slice(newMatrix, rowsNumber, newMatrix.length);\n  };\n\n  // const nextBlockType = blockTypes[(_.indexOf(blockTypes, block.type) + 1) % _.size(blockTypes)];\n  const nextBlockType = blockTypes[0]; // TODO: del after debugging\n  useInterval(() => {\n    if (isPause) return;\n    // TODO: What condition do we have on playground screen? If not solo mode, check if user left Playground screen and stop pieces from falling (issue #66 in github)\n    // if (!username) return; // If user left Playground screen\n    if (_.includes(matrix[0], 1)) {\n      setMatrix(blankMatrix);\n      setIsPause(true);\n      setGameover(true);\n      socketEmitGameover();\n    } else {\n      setBlock((currentBlock) => {\n        if (!isBlockValid(blockFall(currentBlock), matrix)) {\n          const { newMatrix, deletedRows } = destroyBlock(printBlock(block, matrix));\n          setMatrix(newMatrix);\n          // if (deletedRows > 1)\n          if (deletedRows > 0) // TODO: del after debugging\n          //   socketEmitPenaltyRows(deletedRows - 1);\n            socketEmitPenaltyRows(deletedRows); // TODO: del after debugging\n\n          socketEmitUpdateSpectrum(convertMatrixToSpectrum(newMatrix));\n\n          // Update player in state each time he gains score\n          setCurrentPlayer((prevCurrentPlayer) => {\n            if (!prevCurrentPlayer) return;\n            const playerWithUpdatedScore = { ...prevCurrentPlayer, score: prevCurrentPlayer.score + SCORING.PIECE_PLACED + SCORING.ROW_DESTROYED * deletedRows };\n            return playerWithUpdatedScore;\n          });\n          return blockCreate({ type: nextBlockType });\n        } else {\n          return blockFall(currentBlock);\n        }\n      });\n    }\n  }, 500);\n\n  return (\n    <>\n      <Gameboy isPause={isPause} setIsPause={setIsPause} roomPlayers={roomPlayersNames(roomPlayers)} isLeader={player?.isLeader} gameStarted={gameStarted} gameover={gameover} isSoloMode={isSoloMode}>\n        <>\n          {username && room &&\n            <Text style={{ fontSize: 16, marginBottom: 10, alignSelf: 'flex-start' }}>{username} @ {room}</Text>\n          }\n          <View style={{ position: 'absolute', zIndex: 1, marginLeft: 600 }}>\n            <Text>{player?.score}</Text>\n            {_.map(filteredOpponents(roomPlayers, userContext.username || ''), (player) =>\n              <View key={player.id} style={{ width: 85 }}>\n                <View style={{ alignItems: 'center' }}><Text style={{ fontWeight: 'bold', color: 'white' }}>{player.username}</Text></View>\n                <Matrix matrix={player.spectrum} isSpectrum={true} block={blockCreate({ type: nextBlockType, pos: [-10, -10] })}/>\n              </View>)\n            }\n          </View>\n          <View style={{ flexDirection: 'row', alignSelf:'flex-start', width: '100%' }}>\n            <Matrix matrix={matrix} block={block}/>\n            <View style={{ marginLeft: 20, flex: 1 }} >\n              <Text style={{ fontSize: 20 }}>Score</Text>\n              <Digits style={{ marginVertical: 10, alignSelf: 'flex-end' }} />\n              <Text style={{ fontSize: 20 }}>Start Line</Text>\n              <Digits style={{ marginVertical: 10, alignSelf: 'flex-end' }} />\n              <Text style={{ fontSize: 20 }}>Level</Text>\n              <Digits style={{ marginVertical: 10, alignSelf: 'flex-end' }} />\n              <Text style={{ fontSize: 20 }}>Next</Text>\n              <Matrix\n                matrix={blockMatrix}\n                block={blockCreate({ type: nextBlockType, pos: [0, 0] })}\n                style={{ borderWidth: 0, marginVertical: 10, alignSelf: 'flex-end' }}\n              />\n            </View>\n          </View>\n        </>\n      </Gameboy>\n      {room && username &&\n        <ChatWidget title={formatChatTitle(roomLeader?.username ?? 'no leader')} subtitle={formatChatSubtitle(roomPlayersNames(roomPlayers))} handleNewUserMessage={handleNewUserMessage}/>\n      }\n    </>\n  );\n}\n","import  React, { useState, useContext, Dispatch, SetStateAction } from 'react';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { StyleSheet, Text, TouchableOpacity, TextInput, View } from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { SOCKETS } from '/config/constants';\nimport { checkUsername } from '/client/screens/Login/utils';\nimport SocketContext from '/client/context/SocketContext';\nimport UserContext from '/client/context/UserContext';\n\ntype Props = {\n\tsetScreenNumber: Dispatch<SetStateAction<1 | 2>>,\n};\n\nexport default function ChooseUsername(props: Props): JSX.Element {\n  const {setScreenNumber} = props;\n  const { userContext, setUserContext } = useContext(UserContext);\n  const { username } = userContext;\n  const socket = useContext(SocketContext);\n  const navigation = useNavigation<StackNavigationProp<RootStackParamList, 'Root'>>();\n  const [ussernameError, setUsernameError] = useState<string>('');\n\n  const validateUsername = () => {\n    checkUsername(username)\n      .then(data => {\n        if (data === true) {\n          if(!socket) throw Error('No socket');\n          socket.emit(SOCKETS.CREATE_USER, username);\n          setScreenNumber(2);\n        }\n      })\n      .catch(err => {\n        setUsernameError(err.message);\n      });\n  };\n\n  return (\n    <View style={{ width: '100%', alignItems: 'center' }}>\n      <Text style={styles.title}>{'Username'}</Text>\n      <Text style={styles.error}>{ussernameError}</Text>\n      <TextInput\n        value={username ?? ''}\n        onChangeText={text => {\n          setUsernameError('');\n          setUserContext({username: text, room: undefined});\n        }}\n        style={{ borderWidth: 1, marginBottom: 20, height: 30, width: '100%' }}\n      />\n      <TouchableOpacity\n        style={styles.button}\n        onPress={validateUsername}\n      >\n        <Text style={styles.linkText}>Next</Text>\n      </TouchableOpacity>\n      <TouchableOpacity\n        style={styles.button}\n        onPress={() => navigation.push('Playground', {})} // TODO: do we need to validate username here too?\n      >\n        <Text style={styles.linkText}>Solo mode</Text>\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  title: {\n    marginBottom: 5,\n    alignSelf: 'flex-start',\n    textAlign: 'center',\n  },\n  error: {\n    marginBottom: 5,\n    alignSelf: 'flex-start',\n    textAlign: 'center',\n    color: '#980f0f',\n  },\n  linkText: {\n    fontSize: 14,\n  },\n  button: {\n    width: '70%',\n    borderWidth: 1,\n    borderRadius: 10,\n    alignItems: 'center',\n    padding: 3,\n    marginBottom: 30,\n  },\n});\n","import  React, { useState, useEffect, useContext, Dispatch, SetStateAction } from 'react';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { StyleSheet, Text, TouchableOpacity, TextInput, View } from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { SOCKETS } from '/config/constants';\nimport { checkRoomName, isRoomPlayersLimitAvailable } from '/client/screens/Login/utils';\nimport SocketContext from '/client/context/SocketContext';\nimport UserContext from '/client/context/UserContext';\n\ntype Props = {\n  setScreenNumber: Dispatch<SetStateAction<1 | 2>>,\n};\n\nexport default function ChooseRoom(props: Props): JSX.Element {\n  const {setScreenNumber} = props;\n  const { userContext, setUserContext } = useContext(UserContext);\n  const { username, room: roomName } = userContext;\n  const socket = useContext(SocketContext);\n  const navigation = useNavigation<StackNavigationProp<RootStackParamList, 'Root'>>();\n  const [roomNameError, setRoomNameError] = useState<string>('');\n  const [joinRoomError, setJoinRoomError] = useState<string>('');\n  const [waitingRooms, setWaitingRooms] = useState<string[]>([]);\n\n  console.log('Updates for waitingRooms:', waitingRooms);\n\n  const handleFetchWaitingRooms = (roomNames: string[]) => setWaitingRooms(roomNames);\n\n  const handleUpdateWaitingRooms = (roomNames: string[]) => {\n    setRoomNameError('');\n    setJoinRoomError('');\n    return setWaitingRooms(roomNames);\n  };\n\n  useEffect(() => {\n    if (!socket) throw Error('No socket');\n    // If I remove [] from useEffect there is a flood of sockets, for some reason component rerenders several times a second.\n    socket.emit(SOCKETS.FETCH_WAITING_ROOMS);\n\n    // Get waitingRooms when enter ChooseUsername screen\n    socket.on(SOCKETS.FETCH_WAITING_ROOMS, handleFetchWaitingRooms);\n\n    // Get waitingRooms when other users create / delete rooms and ChooseUsername screen is already open\n    socket.on(SOCKETS.UPDATE_WAITING_ROOMS, handleUpdateWaitingRooms);\n  \n    return () => {\n      socket.removeListener(SOCKETS.FETCH_WAITING_ROOMS, handleFetchWaitingRooms);\n      socket.removeListener(SOCKETS.UPDATE_WAITING_ROOMS, handleUpdateWaitingRooms);\n    };\n  }, []);\n\n  const onCreateRoomPress = (roomName: string | undefined) => {\n    checkRoomName(roomName)\n      .then(data => {\n        if (data === true) {\n          if(!socket) throw Error('No socket');\n          socket.emit(SOCKETS.CHOOSE_ROOM, { username, roomName });\n          username && roomName && navigation.push('Playground', { username, room: roomName });\n          setScreenNumber(1);\n        }\n      })\n      .catch(err => {\n        setJoinRoomError('');\n        setRoomNameError(err.message);\n      });\n  };\n\n  const onJoinRoomPress = (roomName: string | null | undefined) => {\n    setRoomNameError('');\n    setJoinRoomError('');\n    isRoomPlayersLimitAvailable(roomName)\n      .then(data => {\n        if (data === true) {\n          setUserContext({ username, room: roomName });\n          if (!socket) throw Error('No socket');\n          socket.emit(SOCKETS.CHOOSE_ROOM, { username, roomName });\n          username && roomName && navigation.push('Playground', { username, room: roomName });\n          setScreenNumber(1);\n        }\n      })\n      .catch(err => {\n        setRoomNameError('');\n        setJoinRoomError(err.message);\n      });\n  };\n\n  return (\n    <View style={{ width: '100%', alignItems: 'center' }}>\n      <Text style={{ fontSize: 16, marginBottom: 50 }}>Hello, {username}</Text>\n      <Text style={styles.title}>Create room</Text>\n      <Text style={styles.error}>{roomNameError}</Text>\n      <TextInput\n        value={roomName ?? ''}\n        onChangeText={text => {\n          setRoomNameError('');\n          setJoinRoomError('');\n          setUserContext({username, room: text});\n        }}\n        style={{ borderWidth: 1, marginBottom: 20, height: 30, width: '100%' }}\n      />\n      <TouchableOpacity\n        style={styles.button}\n        onPress={() => onCreateRoomPress(roomName)}\n      >\n        <Text style={styles.linkText}>Play</Text>\n      </TouchableOpacity>\n      <View style={{ width: '90%', marginTop: 20 }}>\n        {waitingRooms.length > 0 && <Text style={styles.title}>Join room</Text>}\n        <Text style={styles.error}>{joinRoomError}</Text>\n        {waitingRooms.length > 0 && waitingRooms.map((waitingRoom) =>\n          <View key={waitingRoom}>\n            <TouchableOpacity\n              style={styles.roomsList}\n              onPress={() => onJoinRoomPress(waitingRoom)}\n            >\n              <Text>{waitingRoom}</Text>\n            </TouchableOpacity>\n          </View>)}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  title: {\n    marginBottom: 5,\n    alignSelf: 'flex-start',\n    textAlign: 'center',\n  },\n  error: {\n    marginBottom: 5,\n    alignSelf: 'flex-start',\n    textAlign: 'center',\n    color: '#980f0f',\n  },\n  linkText: {\n    fontSize: 14,\n  },\n  roomsList: {\n    borderWidth: 1,\n    borderRadius: 5,\n    margin: 3,\n    padding: 2,\n    alignItems:\n\t\t'center',\n  },\n  button: {\n    width: '70%',\n    borderWidth: 1,\n    borderRadius: 10,\n    alignItems: 'center',\n    padding: 3,\n    marginBottom: 10,\n  },\n});\n","import  React, { useState } from 'react';\nimport { View } from 'react-native';\n\nimport ChooseUsername from '/client/screens/Login/ChooseUsername';\nimport ChooseRoom from '/client/screens/Login/ChooseRoom';\nimport Gameboy from '/client/components/Gameboy';\n\nexport default function Login(): JSX.Element {\n  const [screenNumber, setScreenNumber] = useState<1 | 2>(1);\n\n  return (\n    <Gameboy>\n      <View style={{ alignItems: 'center', width: '60%' }}>\n        {screenNumber === 1\n          ? <ChooseUsername setScreenNumber={setScreenNumber} />\n          : <ChooseRoom setScreenNumber={setScreenNumber} />\n        }\n      </View>\n    </Gameboy>\n  );\n}","/* eslint-env browser */\n\nif ('serviceWorker' in navigator) {\n  window.addEventListener('load', function () {\n    navigator.serviceWorker\n      .register('/42-red-tetris/expo-service-worker.js', { scope: '/42-red-tetris/' })\n      .then(function (info) {\n        // console.info('Registered service-worker', info);\n      })\n      .catch(function (error) {\n        console.info('Failed to register service-worker', error);\n      });\n  });\n}\n","export const keyboard = {\n  'left': 37,\n  'rotate': 38,\n  'right': 39,\n  'down': 40,\n  'space': 32,\n  'sound': 83,\n  'reset': 82,\n  // 'pause': 80,\n};\n","module.exports = __webpack_public_path__ + \"static/media/sprite.81de6409.png\";","import {createContext} from 'react';\n\nconst userContext = {username: undefined, room: undefined};\n\nconst UserContext = createContext<{userContext: UserContextType, setUserContext: UpdateUserContextType}>({\n  userContext,\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  setUserContext: () => {},\n});\n\nexport default UserContext;\n","import {createContext} from 'react';\n\nconst SocketContext = createContext<undefined | SocketIOClient.Socket>(undefined);\n\nexport default SocketContext;\n","import { TouchableOpacity, View, Text, ViewStyle } from 'react-native';\nimport React, { useContext, Dispatch, SetStateAction } from 'react';\nimport { StackNavigationProp } from '@react-navigation/stack';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { keyboard } from '/client/constants/keyboard';\nimport { SOCKETS } from '/config/constants';\nimport SocketContext from '/client/context/SocketContext';\nimport UserContext from '/client/context/UserContext';\n\nconst RoundButton = ({\n  size, color, label, style, onPress, disabled, text,\n}: {\n  size: number, color: string, label?: string,\n  style?: ViewStyle, onPress?: () => void, disabled?: boolean, text?: string,\n}): JSX.Element => {\n  const button = React.useRef<TouchableOpacity>(null);\n\n  return (\n    <View style={[{ alignItems: 'center' }, style]}>\n      <TouchableOpacity\n        ref={button}\n        disabled={disabled}\n        onPress={() => { button?.current?.blur(); onPress?.();}}\n        style={{\n          backgroundColor: color,\n          borderRadius: size / 2,\n          height: size,\n          width: size,\n          shadowColor: 'rgba(0,0,0, .4)',\n          shadowOffset: { height: 1, width: 1 },\n          shadowOpacity: 20,\n          shadowRadius: 5,\n          justifyContent: 'center',\n          alignItems: 'center',\n        }} >\n        {text && <Text style={{ fontSize: 25 }}>{text}</Text>}\n      </TouchableOpacity>\n      {label && <Text style={{ marginTop: 10 }}>{label}</Text>}\n    </View>\n  );\n};\n\ntype Props = {\n  isPause?: boolean,\n  setIsPause: Dispatch<SetStateAction<boolean>>,\n  opponentsNumber: number,\n  isLeader?: boolean,\n  gameStarted?: boolean,\n  disabled?: boolean,\n  isSoloMode?: boolean,\n}\n\nconst Keypad = (props: Props): JSX.Element => {\n  const { isPause, setIsPause, opponentsNumber, isLeader, gameStarted, disabled, isSoloMode } = props;\n  const socket = useContext(SocketContext);\n  const { userContext, setUserContext } = useContext(UserContext);\n  const navigation = useNavigation<StackNavigationProp<RootStackParamList, 'Playground'>>();\n  const showStartButton = !isSoloMode && isLeader && !gameStarted;\n  const showPauseButton = (isLeader && gameStarted ) || isSoloMode;\n  const isButtonDisabled = !isSoloMode && (disabled || opponentsNumber < 1);\n\n  const keyDown = (key: number) => {\n    // @ts-ignore https://github.com/microsoft/TSJS-lib-generator/pull/892\n    document.dispatchEvent(new KeyboardEvent('keydown', { keyCode: key, which: key }));\n  };\n  return (\n    <View style={{ width: 400 }}>\n      <View style={{ width: '100%' }}>\n        <View style={{ flexDirection: 'row', marginVertical: 20, justifyContent: 'space-between'}}>\n          {showStartButton &&\n          <RoundButton\n            color={isButtonDisabled ? '#c0c0c0' : '#2dc421'} size={50} label='Start' text='▶'\n            disabled={isButtonDisabled}\n            onPress={() => {\n              if (!socket) throw Error('No socket');\n              socket.emit(SOCKETS.START_GAME, { username: userContext.username, roomName: userContext.room });\n            }}\n          />}\n          {showPauseButton &&\n            <RoundButton\n              disabled={isButtonDisabled}\n              color={isButtonDisabled ? '#c0c0c0' : '#efcc19'} size={50} label={isPause ? 'Play(P)' : 'Pause(P)'} text={isPause ? '▶' : '||' }\n              onPress={() => {\n                if (!socket) throw Error('No socket');\n                socket.emit(SOCKETS.PAUSE_GAME, { username: userContext.username, roomName: userContext.room });\n              }}\n            />}\n          <RoundButton\n            disabled={isButtonDisabled}\n            color={isButtonDisabled ? '#c0c0c0' : '#2dc421'} size={50} label=\"Sound(S)\"\n            onPress={() => keyDown(keyboard.sound)}\n          />\n          <RoundButton\n            disabled={isButtonDisabled}\n            color={isButtonDisabled ? '#c0c0c0' : '#efcc19'} size={50} label=\"Reset(R)\"\n            onPress={() => keyDown(keyboard.reset)}\n          />\n          <RoundButton\n            color=\"white\" size={50} style={{ margin: 0 }} label='Exit' text='╳'\n            onPress={() => {\n              if (!socket) throw Error('No socket');\n              setUserContext({username: undefined, room: undefined});\n              setIsPause(true);\n              socket.emit(SOCKETS.PLAYER_LEFT, userContext.username);\n              navigation.navigate('Root');\n            }}\n          />\n        </View>\n        <View style={{ flexDirection: 'row', alignItems: 'center', marginTop: 20 }}>\n          <View style={{ marginRight: 20 }}>\n            <RoundButton\n              color={isButtonDisabled ? '#c0c0c0' : '#5a65f1'} size={160} label=\"Drop(Space)\" style={{ marginTop: 20 }}\n              disabled={isButtonDisabled || isPause}\n              onPress={() => keyDown(keyboard.space)}\n            />\n          </View>\n          <View style={{ marginLeft: 20 }}>\n            <RoundButton\n              color={isButtonDisabled ? '#c0c0c0' : '#5a65f1'} size={70} style={{ margin: 0 }}\n              disabled={isButtonDisabled || isPause}\n              onPress={() => keyDown(keyboard.rotate)}\n            />\n            <View style={{ flexDirection: 'row' }}>\n              <RoundButton\n                color={isButtonDisabled ? '#c0c0c0' : '#5a65f1'} size={70} style={{ margin: 0, marginRight: 60 }}\n                disabled={isButtonDisabled || isPause}\n                onPress={() => keyDown(keyboard.left)}\n              />\n              <RoundButton\n                color={isButtonDisabled ? '#c0c0c0' : '#5a65f1'} size={70} style={{ margin: 0 }}\n                disabled={isButtonDisabled || isPause}\n                onPress={() => keyDown(keyboard.right)}\n              />\n            </View>\n            <RoundButton\n              color={isButtonDisabled ? '#c0c0c0' : '#5a65f1'} size={70} style={{ margin: 0 }}\n              disabled={isButtonDisabled || isPause}\n              onPress={() => keyDown(keyboard.down)}\n            />\n          </View>\n        </View>\n      </View>\n    </View>\n  );\n};\n\nexport default Keypad;\n","import { Dimensions, ScaledSize } from 'react-native';\nimport * as React from 'react';\n\ntype EventValue = {\n  window: ScaledSize;\n  screen: ScaledSize;\n};\n\nexport const useDimensionsSync = (dim: 'window' | 'screen' = 'window'): { width: number, height: number } => {\n  const [dimensions, setDimensions] = React.useState(() => Dimensions.get(dim));\n\n  // Start listening to changes\n  React.useEffect(() => {\n    let stillCareAboutTheCallback = true;\n\n    const updateDimensions = (nextDimensions: EventValue) => {\n      stillCareAboutTheCallback && setDimensions(nextDimensions[dim]);\n    };\n\n    Dimensions.addEventListener('change', updateDimensions);\n\n    return () => {\n      stillCareAboutTheCallback = false;\n      Dimensions.removeEventListener('change', updateDimensions);\n    };\n  }, [dim, setDimensions]);\n\n  return dimensions;\n};\n\nexport const useWindowDimensions = (): { width: number, height: number } => {\n  return useDimensionsSync('window');\n};\n","import React from 'react';\nimport { Text, View } from 'react-native';\n\nimport { styles } from '/client/components/Gameboy';\nimport { maxPlayersLimit } from '/client/constants/game';\n\n\ntype Props = {\n  isMultiplayerMode: boolean,\n  opponentsNumber: number,\n  isLeader?: boolean,\n  gameover?: boolean,\n}\n\nconst PreviewText = (props: Props): JSX.Element  => {\n  const { isMultiplayerMode, opponentsNumber, isLeader, gameover } = props;\n  const secondLineText = (opponentsNumber: number, isLeader?: boolean) => {\n    if (opponentsNumber <= 0) return 'Wait for other players';\n    if (opponentsNumber > 0 && (opponentsNumber + 1 >= maxPlayersLimit) && isLeader) return 'Room is full, press Start to begin';\n    if (opponentsNumber > 0 && isLeader) return 'Press Start to begin';\n    if (opponentsNumber > 0 && (opponentsNumber + 1 >= maxPlayersLimit) && !isLeader) return 'Room is full, ask leader to start the game';\n    if (opponentsNumber > 0 && !isLeader) return 'Wait for leader to start the game';\n  };\n\n  if (gameover) {\n    return (\n      <View style={{ alignItems: 'center' }}>\n        <Text style={styles.gameover}>Game Over</Text>\n        <Text style={styles.gameMode}>Please wait for other players to finish</Text>\n      </View>\n    );\n  }\n  if (isMultiplayerMode) {\n    return (\n      <View style={{ alignItems: 'center' }}>\n        <Text style={styles.gameMode}>You are in multiplayer mode</Text>\n        <Text style={styles.gameMode}>{opponentsNumber} other player(s) in your room</Text>\n        <Text>{secondLineText(opponentsNumber, isLeader)}</Text>\n      </View>\n    );\n  }\n  return (\n    <View style={{ alignItems: 'center' }}>\n      <Text style={styles.gameMode}>You are in solo mode</Text>\n      <Text>Press Play(P) to start</Text>\n    </View>\n  );\n};\n\nexport default PreviewText;\n","import { StyleSheet, Text, View } from 'react-native';\nimport React, { useContext, Dispatch, SetStateAction } from 'react';\n\nimport Keypad from '/client/components/Keypad';\nimport { useWindowDimensions } from '/client/hooks/useWindowDimensions';\nimport UserContext from '/client/context/UserContext';\nimport PreviewText from '/client/components/Gameboy/PreviewText';\n\ntype Props = {\n  children: React.ReactChild,\n  isPause?: boolean,\n  setIsPause: Dispatch<SetStateAction<boolean>>,\n  roomPlayers?: string[],\n  isLeader?: boolean,\n  gameStarted?: boolean,\n  gameover?: boolean,\n  isSoloMode?: boolean,\n}\n\nexport default function Gameboy(props: Props): JSX.Element {\n  const {children, isPause, setIsPause, roomPlayers, isLeader, gameStarted, gameover, isSoloMode} = props;\n  const {userContext} = useContext(UserContext);\n  const opponentsNumber = !roomPlayers || roomPlayers.length === 0 ? 0 : roomPlayers.length - 1;\n  const isMultiplayerMode = userContext.username && userContext.room ? true : false;\n  const window = useWindowDimensions();\n  const w = window.width;\n  const h = window.height;\n  const ratio = h / w;\n  let scale;\n  if (ratio < 1.5) {\n    scale = h / 960;\n  } else {\n    scale = w / 560;\n  }\n\n  const isKeypadDisabled = gameover;\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.gameboy, { transform: [{ scale }] }]}>\n        <Text style={styles.title}>R E D ■ T E T R I S</Text>\n        <View style={styles.display}>\n          {children}\n          {isPause ?\n            <View style={[styles.display, { position: 'absolute', opacity: 0.8 }]} >\n              <PreviewText isMultiplayerMode={isMultiplayerMode} opponentsNumber={opponentsNumber} isLeader={isLeader} gameover={gameover} />\n            </View>\n            : null}\n        </View>\n        <Keypad isPause={isPause} setIsPause={setIsPause} opponentsNumber={opponentsNumber} isLeader={isLeader} gameStarted={gameStarted} disabled={isKeypadDisabled} isSoloMode={isSoloMode}/>\n      </View>\n    </View>\n  );\n}\n\nexport const styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#1f393e',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 20,\n    height: '100%',\n  },\n  display: {\n    alignItems: 'center',\n    backgroundColor: '#9ead86',\n    borderBottomColor: '#fa6b6b',\n    borderLeftColor: '#980f0f',\n    borderRightColor: '#fa6b6b',\n    borderTopColor: '#980f0f',\n    borderWidth: 5,\n    height: 500,\n    justifyContent: 'center',\n    padding: 10,\n    width: 400,\n  },\n  gameboy: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#990011',\n    borderRadius: 20,\n    paddingBottom: 30,\n    paddingHorizontal: 50,\n  },\n  title: {\n    fontSize: 30,\n    marginVertical: 15,\n    textAlign: 'center',\n  },\n  gameMode: {\n    marginBottom: 20,\n    fontSize: 18,\n  },\n  gameover: {\n    marginBottom: 20,\n    fontWeight: 'bold',\n    color: '#990011',\n    fontSize: 24,\n  },\n});\n"],"sourceRoot":""}